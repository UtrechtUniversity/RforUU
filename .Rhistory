distance = "bray",
k = 2,
trymax = 100)
which(apply(poem_data_wide[,5:ncol(poem_data_wide)], 2, sum)==0)
poem_data_wide <- poem_data |>
mutate(Std_biomass=Biomass/0.1, #Convert to g/mÂ²
.after = "Biomass") |>  #Specify that we want this new column to be after the Biomass column
group_by(Year, Harvest, PlotID, Arrival, Species) |> #Define grouping factors in your data
summarise(Std_biomass=mean(Std_biomass)) |>
pivot_wider(names_from = Species, #Species names will be used as column names
values_from = Std_biomass, #Biomass values are stored in the Std_biomass column
values_fill = 0, #If a species is absent in a plot, its biomass value is zero
values_fn = sum) |>  #Sum biomass values measured on the same species and in the same quadrat
filter((Year == 2020 & Harvest == "2021-06")|(Year == 2021 & Harvest == "2022-06")) |>  #Filter data
select(where( ~ is.numeric(.x) && sum(.x) != 0)) |>
select(-Unknown)
#| eval: true
#| echo: false
#| warning: false
#| message: false
set.seed(12345)
nmds <- metaMDS(comm = poem_data_wide[,5:ncol(poem_data_wide)],
distance = "bray",
k = 2,
trymax = 100)
plot(nmds)
stressplot(nmds)
#| eval: true
#| echo: false
#| warning: false
#| message: false
set.seed(123)
nmds <- metaMDS(comm = poem_data_wide[,5:ncol(poem_data_wide)],
distance = "bray",
k = 2,
trymax = 100)
nmds$stress
#| eval: true
#| echo: true
#| warning: false
#| message: false
data_nmds <- cbind(poem_data_wide[, 1:4], nmds$points)
View(data_nmds)
data_nmds |>
ggplot(aes(x = NMDS1,
y = NMDS2,
fill = Arrival,
shape = Year))+
geom_point(colour="darkgrey")+
theme_bw()+
scale_fill_viridis(discrete = TRUE,
option = "D")+
scale_shape_manual(values = c(21, 23))
library(viridis)
data_nmds |>
ggplot(aes(x = NMDS1,
y = NMDS2,
fill = Arrival,
shape = Year))+
geom_point(colour="darkgrey")+
theme_bw()+
scale_fill_viridis(discrete = TRUE,
option = "D")+
scale_shape_manual(values = c(21, 23))
data_nmds |>
ggplot(aes(x = MDS1,
y = MDS2,
fill = Arrival,
shape = Year))+
geom_point(colour="darkgrey")+
theme_bw()+
scale_fill_viridis(discrete = TRUE,
option = "D")+
scale_shape_manual(values = c(21, 23))
#| eval: true
#| echo: true
#| warning: false
#| message: false
#Make sure that Arrival and Year are factors
data_nmds$Arrival <- factor(data_nmds$Arrival,
levels=c("S", "F", "G", "L", "B"))
data_nmds$Year <- factor(data_nmds$Year,
levels=c("2020", "2021"))
#Plot results
(plot <- data_nmds |>
ggplot(aes(x = MDS1,
y = MDS2,
fill = Arrival,
shape = Year))+
geom_point(colour="darkgrey")+
theme_bw()+
scale_fill_viridis(discrete = TRUE,
option = "D")+
scale_shape_manual(values = c(21, 23)))
#| eval: true
#| echo: true
#| warning: false
#| message: false
#Make sure that Arrival and Year are factors
data_nmds$Arrival <- factor(data_nmds$Arrival,
levels=c("S", "F", "G", "L", "B"))
data_nmds$Year <- factor(data_nmds$Year,
levels=c("2020", "2021"))
#Plot results
(plot <- data_nmds |>
ggplot(aes(x = MDS1,
y = MDS2,
fill = Arrival,
shape = Year))+
geom_point(colour="darkgrey")+
theme_bw()+
scale_fill_viridis(discrete = TRUE,
option = "D")+
scale_shape_manual(values = c(21, 22)))
#| eval: true
#| echo: true
#| warning: false
#| message: false
#Make sure that Arrival and Year are factors
data_nmds$Arrival <- factor(data_nmds$Arrival,
levels=c("S", "F", "G", "L", "B"))
data_nmds$Year <- factor(data_nmds$Year,
levels=c("2020", "2021"))
#Plot results
(plot <- data_nmds |>
ggplot(aes(x = MDS1,
y = MDS2,
fill = Arrival,
shape = Year))+
geom_point(colour="darkgrey")+
theme_bw()+
scale_fill_viridis(discrete = TRUE,
option = "D")+
scale_shape_manual(values = c(21, 24)))
#| eval: true
#| echo: true
#| warning: false
#| message: false
#Make sure that Arrival and Year are factors
data_nmds$Arrival <- factor(data_nmds$Arrival,
levels=c("S", "F", "G", "L", "B"))
data_nmds$Year <- factor(data_nmds$Year,
levels=c("2020", "2021"))
#Plot results
(plot <- data_nmds |>
ggplot(aes(x = MDS1,
y = MDS2,
colour = Arrival,
shape = Year))+
geom_point(colour="darkgrey")+
theme_bw()+
scale_colour_viridis(discrete = TRUE,
option = "D")+
scale_shape_manual(values = c(16, 17)))
#| eval: true
#| echo: true
#| warning: false
#| message: false
#Make sure that Arrival and Year are factors
data_nmds$Arrival <- factor(data_nmds$Arrival,
levels=c("S", "F", "G", "L", "B"))
data_nmds$Year <- factor(data_nmds$Year,
levels=c("2020", "2021"))
#Plot results
(plot <- data_nmds |>
ggplot(aes(x = MDS1,
y = MDS2,
colour = Arrival,
shape = Year))+
geom_point()+
theme_bw()+
scale_colour_viridis(discrete = TRUE,
option = "D")+
scale_shape_manual(values = c(16, 17)))
#| eval: true
#| echo: true
#| warning: false
#| message: false
#Make sure that Arrival and Year are factors
data_nmds$Arrival <- factor(data_nmds$Arrival,
levels=c("S", "F", "G", "L", "B"))
data_nmds$Year <- factor(data_nmds$Year,
levels=c("2020", "2021"))
#Plot results
(plot <- data_nmds |>
ggplot(aes(x = MDS1,
y = MDS2,
colour = Arrival,
shape = Year))+
geom_point()+
theme_bw()+
scale_colour_viridis(name = "Plant order of arrival",
discrete = TRUE,
option = "D")+
scale_shape_manual(values = c(16, 17)))
(plot <- data_nmds |>
ggplot(aes(x = MDS1,
y = MDS2,
colour = Arrival,
shape = Year))+
geom_point()+
theme_bw()+
scale_colour_viridis(name = "Plant order of arrival",
discrete = TRUE,
option = "D")+
scale_shape_manual(name = "Year of initiation",
values = c(16, 17)))
(plot <- data_nmds |>
ggplot(aes(x = MDS1,
y = MDS2,
colour = Arrival,
shape = Year))+
geom_point()+
theme_bw()+
scale_colour_viridis(name = "Plant order of arrival",
discrete = TRUE,
option = "D")+
scale_shape_manual(name = "Year of initiation",
values = c(16, 17)))+
theme(axis.text = element_text(colour="black"),
axis.title.x = element_text(margin = margin(t=10)),
axis.title.y = element_text(margin = margin(r=10)))
(plot <- data_nmds |>
ggplot(aes(x = MDS1,
y = MDS2,
colour = Arrival,
shape = Year))+
geom_point(size=2)+
theme_bw()+
scale_colour_viridis(name = "Plant order of arrival",
discrete = TRUE,
option = "D")+
scale_shape_manual(name = "Year of initiation",
values = c(16, 17)))+
theme(axis.text = element_text(colour="black"),
axis.title.x = element_text(margin = margin(t=10)),
axis.title.y = element_text(margin = margin(r=10)))
inborutils::download_zenodo(doi="10.5281/zenodo.10119982",
quiet=TRUE)
unzip(zipfile = "Data_POEM_Paper1_Alonso-Crespo_et_al_2024-v1.0.zip",
exdir = "Data_POEM")
plot <- data_nmds |>
ggplot(aes(x = MDS1,
y = MDS2,
colour = Arrival,
shape = Year))+
geom_point(size=2)+
theme_bw()+
scale_colour_viridis(name = "Plant order of arrival",
discrete = TRUE,
option = "D")+
scale_shape_manual(name = "Year of initiation",
values = c(16, 17))+
theme(axis.text = element_text(colour="black"),
axis.title.x = element_text(margin = margin(t=10)),
axis.title.y = element_text(margin = margin(r=10)))+
xlab("NMDS1")+
ylab("NMDS2")+
geom_text(data=data.frame(), aes(label = 'sometext', x = -Inf, y = Inf),
hjust = 0, vjust = 1)
plot
plot <- data_nmds |>
ggplot(aes(x = MDS1,
y = MDS2,
colour = Arrival,
shape = Year))+
geom_point(size=2)+
theme_bw()+
scale_colour_viridis(name = "Plant order of arrival",
discrete = TRUE,
option = "D")+
scale_shape_manual(name = "Year of initiation",
values = c(16, 17))+
theme(axis.text = element_text(colour="black"),
axis.title.x = element_text(margin = margin(t=10)),
axis.title.y = element_text(margin = margin(r=10)))+
xlab("NMDS1")+
ylab("NMDS2")+
geom_text(data=data.frame(), aes(label = 'sometext', x = -Inf, y = Inf),
hjust = 0, vjust = 1, inherit.aes = FALSE)
plot
plot <- data_nmds |>
ggplot(aes(x = MDS1,
y = MDS2,
colour = Arrival,
shape = Year))+
geom_point(size=2)+
theme_bw()+
scale_colour_viridis(name = "Plant order of arrival",
discrete = TRUE,
option = "D")+
scale_shape_manual(name = "Year of initiation",
values = c(16, 17))+
theme(axis.text = element_text(colour="black"),
axis.title.x = element_text(margin = margin(t=10)),
axis.title.y = element_text(margin = margin(r=10)))+
xlab("NMDS1")+
ylab("NMDS2")+
geom_text(data=data.frame(x=min(data_nmds$MDS1),
y=max(data_nmds$MDS2),
label=paste("Stress = ",
round(nmds$stress, 3),
sep="")),
aes(x = x,
y = y,
label = label),
hjust = 0,
vjust = 1,
inherit.aes = FALSE)
plot
plot <- data_nmds |>
ggplot(aes(x = MDS1,
y = MDS2,
colour = Arrival,
shape = Year))+
geom_point(size=2)+
theme_bw()+
scale_colour_viridis(name = "Plant order of arrival",
discrete = TRUE,
option = "D")+
scale_shape_manual(name = "Year of initiation",
values = c(16, 17))+
theme(axis.text = element_text(colour="black"),
axis.title.x = element_text(margin = margin(t=10)),
axis.title.y = element_text(margin = margin(r=10)))+
xlab("NMDS1")+
ylab("NMDS2")+
geom_text(data=data.frame(x=min(data_nmds$MDS1),
y=max(data_nmds$MDS2),
label=paste("Stress = ",
round(nmds$stress, 3),
sep="")),
aes(x = x,
y = y,
label = label),
hjust = 0,
vjust = 0,
inherit.aes = FALSE)
plot <- data_nmds |>
ggplot(aes(x = MDS1,
y = MDS2,
colour = Arrival,
shape = Year))+
geom_point(size=2)+
theme_bw()+
scale_colour_viridis(name = "Plant order of arrival",
discrete = TRUE,
option = "D")+
scale_shape_manual(name = "Year of initiation",
values = c(16, 17))+
theme(axis.text = element_text(colour="black"),
axis.title.x = element_text(margin = margin(t=10)),
axis.title.y = element_text(margin = margin(r=10)))+
xlab("NMDS1")+
ylab("NMDS2")+
geom_text(data=data.frame(x=min(data_nmds$MDS1),
y=max(data_nmds$MDS2),
label=paste("Stress = ",
round(nmds$stress, 3),
sep="")),
aes(x = x,
y = y,
label = label),
hjust = 0,
vjust = 0,
inherit.aes = FALSE)
plot
plot <- data_nmds |>
ggplot(aes(x = MDS1,
y = MDS2,
colour = Arrival,
shape = Year))+
geom_point(size=2)+
theme_bw()+
scale_colour_viridis(name = "Plant order of arrival",
discrete = TRUE,
option = "D")+
scale_shape_manual(name = "Year of initiation",
values = c(16, 17))+
theme(axis.text = element_text(colour="black"),
axis.title.x = element_text(margin = margin(t=10)),
axis.title.y = element_text(margin = margin(r=10)))+
xlab("NMDS1")+
ylab("NMDS2")+
geom_text(data=data.frame(x=min(data_nmds$MDS1),
y=max(data_nmds$MDS2),
label=paste("Stress = ",
round(nmds$stress, 3),
sep="")),
aes(x = x,
y = y,
label = label),
hjust = 1,
vjust = 0,
inherit.aes = FALSE)
plot
plot <- data_nmds |>
ggplot(aes(x = MDS1,
y = MDS2,
colour = Arrival,
shape = Year))+
geom_point(size=2)+
theme_bw()+
scale_colour_viridis(name = "Plant order of arrival",
discrete = TRUE,
option = "D")+
scale_shape_manual(name = "Year of initiation",
values = c(16, 17))+
theme(axis.text = element_text(colour="black"),
axis.title.x = element_text(margin = margin(t=10)),
axis.title.y = element_text(margin = margin(r=10)))+
xlab("NMDS1")+
ylab("NMDS2")+
geom_text(data=data.frame(x=min(data_nmds$MDS1),
y=max(data_nmds$MDS2),
label=paste("Stress = ",
round(nmds$stress, 3),
sep="")),
aes(x = x,
y = y,
label = label),
hjust = 0.5,
vjust = 0,
inherit.aes = FALSE)
plot
plot <- data_nmds |>
ggplot(aes(x = MDS1,
y = MDS2,
colour = Arrival,
shape = Year))+
geom_point(size=2)+
theme_bw()+
scale_colour_viridis(name = "Plant order of arrival",
discrete = TRUE,
option = "D")+
scale_shape_manual(name = "Year of initiation",
values = c(16, 17))+
theme(axis.text = element_text(colour="black"),
axis.title.x = element_text(margin = margin(t=10)),
axis.title.y = element_text(margin = margin(r=10)))+
xlab("NMDS1")+
ylab("NMDS2")+
geom_text(data=data.frame(x=min(data_nmds$MDS1),
y=max(data_nmds$MDS2),
label=paste("Stress = ",
round(nmds$stress, 3),
sep="")),
aes(x = x,
y = y,
label = label),
hjust = 0.8,
vjust = 0,
inherit.aes = FALSE)
plot
plot <- data_nmds |>
ggplot(aes(x = MDS1,
y = MDS2,
colour = Arrival,
shape = Year))+
geom_point(size=2)+
theme_bw()+
scale_colour_viridis(name = "Plant order of arrival",
discrete = TRUE,
option = "D")+
scale_shape_manual(name = "Year of initiation",
values = c(16, 17))+
theme(axis.text = element_text(colour="black"),
axis.title.x = element_text(margin = margin(t=10)),
axis.title.y = element_text(margin = margin(r=10)))+
xlab("NMDS1")+
ylab("NMDS2")+
geom_text(data=data.frame(x=min(data_nmds$MDS1),
y=max(data_nmds$MDS2),
label=paste("Stress = ",
round(nmds$stress, 3),
sep="")),
aes(x = x,
y = y,
label = label),
hjust = 0.2,
vjust = 0,
inherit.aes = FALSE)
plot
plot <- data_nmds |>
ggplot(aes(x = MDS1,
y = MDS2,
colour = Arrival,
shape = Year))+
geom_point(size=2)+
theme_bw()+
scale_colour_viridis(name = "Plant order of arrival",
discrete = TRUE,
option = "D")+
scale_shape_manual(name = "Year of initiation",
values = c(16, 17))+
theme(axis.text = element_text(colour="black"),
axis.title.x = element_text(margin = margin(t=10)),
axis.title.y = element_text(margin = margin(r=10)))+
xlab("NMDS1")+
ylab("NMDS2")+
geom_text(data=data.frame(x=min(data_nmds$MDS1),
y=max(data_nmds$MDS2),
label=paste("Stress = ",
round(nmds$stress, 3),
sep="")),
aes(x = x,
y = y,
label = label),
hjust = 0.1,
vjust = 0,
inherit.aes = FALSE)
plot
