<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.433">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Benjamin Delory">

<title>Ecological field research (GEO2-2439) - Tutorial 5: Data analysis in R</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./contact.html" rel="next">
<link href="./data_exploration.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-sidebar docked">


<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./R_basics.html">Tutorials</a></li><li class="breadcrumb-item"><a href="./data_analysis.html">Data analysis</a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
      <a href="./index.html" class="sidebar-logo-link">
      <img src="./uu-logo-en-geenwitruimte.png" alt="" class="sidebar-logo py-0 d-lg-inline d-none">
      </a>
      <div class="sidebar-tools-main">
    <div class="dropdown">
      <a href="" title="" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" aria-label=""><i class="bi bi-github"></i></a>
      <ul class="dropdown-menu" aria-labelledby="quarto-navigation-tool-dropdown-0">
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://github.com/UtrechtUniversity/RforUU">
            Source code
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://github.com/UtrechtUniversity/RforUU/issues">
            Report an issue
            </a>
          </li>
      </ul>
    </div>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Course information</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./about.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">About the course</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./prerequisites.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Prerequisites</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
 <span class="menu-text">Tutorials</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./R_basics.html" class="sidebar-item-text sidebar-link"><i class="bi bi-play-fill" role="img">
</i> 
 <span class="menu-text">R basics</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data_wrangling.html" class="sidebar-item-text sidebar-link"><i class="bi bi-table" role="img">
</i> 
 <span class="menu-text">Data wrangling</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data_visualisation.html" class="sidebar-item-text sidebar-link"><i class="bi bi-bar-chart-line-fill" role="img">
</i> 
 <span class="menu-text">Data visualisation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./quantifying_biodiversity.html" class="sidebar-item-text sidebar-link"><i class="bi bi-globe" role="img">
</i> 
 <span class="menu-text">Quantifying biodiversity</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data_exploration.html" class="sidebar-item-text sidebar-link"><i class="bi bi-binoculars-fill" role="img">
</i> 
 <span class="menu-text">Data exploration</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data_analysis.html" class="sidebar-item-text sidebar-link active"><i class="bi bi-laptop" role="img">
</i> 
 <span class="menu-text">Data analysis</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
 <span class="menu-text">Contact</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./contact.html" class="sidebar-item-text sidebar-link"><i class="bi bi-envelope-at-fill" role="img">
</i> 
 <span class="menu-text">Contact</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#about-this-tutorial" id="toc-about-this-tutorial" class="nav-link active" data-scroll-target="#about-this-tutorial">About this tutorial</a></li>
  <li><a href="#importing-poem-data" id="toc-importing-poem-data" class="nav-link" data-scroll-target="#importing-poem-data">Importing POEM data</a>
  <ul>
  <li><a href="#download-the-poem-data-from-zenodo" id="toc-download-the-poem-data-from-zenodo" class="nav-link" data-scroll-target="#download-the-poem-data-from-zenodo">Download the POEM data from Zenodo</a></li>
  <li><a href="#load-r-packages" id="toc-load-r-packages" class="nav-link" data-scroll-target="#load-r-packages">Load R packages</a></li>
  <li><a href="#import-data-into-r" id="toc-import-data-into-r" class="nav-link" data-scroll-target="#import-data-into-r">Import data into R</a></li>
  </ul></li>
  <li><a href="#organise-poem-data" id="toc-organise-poem-data" class="nav-link" data-scroll-target="#organise-poem-data">Organise POEM data</a></li>
  <li><a href="#exercise-1-do-plant-order-of-arrival-and-year-of-initiation-of-an-experiment-affect-the-total-aboveground-biomass-production-of-plant-communities" id="toc-exercise-1-do-plant-order-of-arrival-and-year-of-initiation-of-an-experiment-affect-the-total-aboveground-biomass-production-of-plant-communities" class="nav-link" data-scroll-target="#exercise-1-do-plant-order-of-arrival-and-year-of-initiation-of-an-experiment-affect-the-total-aboveground-biomass-production-of-plant-communities">Exercise 1: Do plant order of arrival and year of initiation of an experiment affect the total aboveground biomass production of plant communities?</a>
  <ul>
  <li><a href="#step-1-calculate-the-total-biomass-production-in-each-plot" id="toc-step-1-calculate-the-total-biomass-production-in-each-plot" class="nav-link" data-scroll-target="#step-1-calculate-the-total-biomass-production-in-each-plot">Step 1: Calculate the total biomass production in each plot</a></li>
  <li><a href="#step-2-visualise-raw-data" id="toc-step-2-visualise-raw-data" class="nav-link" data-scroll-target="#step-2-visualise-raw-data">Step 2: Visualise raw data</a></li>
  <li><a href="#step-3-fit-a-model" id="toc-step-3-fit-a-model" class="nav-link" data-scroll-target="#step-3-fit-a-model">Step 3: Fit a model</a></li>
  <li><a href="#step-4-compare-group-means" id="toc-step-4-compare-group-means" class="nav-link" data-scroll-target="#step-4-compare-group-means">Step 4: Compare group means</a></li>
  <li><a href="#step-5-add-posthoc-test-results-to-the-graph" id="toc-step-5-add-posthoc-test-results-to-the-graph" class="nav-link" data-scroll-target="#step-5-add-posthoc-test-results-to-the-graph">Step 5: Add posthoc test results to the graph</a></li>
  </ul></li>
  <li><a href="#exercise-2-non-metric-multidimensional-scaling" id="toc-exercise-2-non-metric-multidimensional-scaling" class="nav-link" data-scroll-target="#exercise-2-non-metric-multidimensional-scaling">Exercise 2: Non-metric multidimensional scaling</a>
  <ul>
  <li><a href="#step-1-choose-a-measure-of-association" id="toc-step-1-choose-a-measure-of-association" class="nav-link" data-scroll-target="#step-1-choose-a-measure-of-association">Step 1: Choose a measure of association</a></li>
  <li><a href="#step-2-organise-your-data" id="toc-step-2-organise-your-data" class="nav-link" data-scroll-target="#step-2-organise-your-data">Step 2: Organise your data</a></li>
  <li><a href="#step-3-perform-the-nmds" id="toc-step-3-perform-the-nmds" class="nav-link" data-scroll-target="#step-3-perform-the-nmds">Step 3: Perform the NMDS</a></li>
  <li><a href="#step-4-check-nmds-results" id="toc-step-4-check-nmds-results" class="nav-link" data-scroll-target="#step-4-check-nmds-results">Step 4: Check NMDS results</a></li>
  <li><a href="#step-5-visualise-nmds-results" id="toc-step-5-visualise-nmds-results" class="nav-link" data-scroll-target="#step-5-visualise-nmds-results">Step 5: Visualise NMDS results</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Tutorial 5: Data analysis in R</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
</div>


<div class="quarto-title-meta-author">
  <div class="quarto-title-meta-heading">Author</div>
  <div class="quarto-title-meta-heading">Affiliation</div>
  
    <div class="quarto-title-meta-contents">
    <p class="author">Benjamin Delory <a href="https://orcid.org/0000-0002-1190-8060" class="quarto-title-author-orcid"> <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg=="></a></p>
  </div>
    <div class="quarto-title-meta-contents">
        <p class="affiliation">
            Environmental sciences group, Copernicus institute of sustainable development, Utrecht University
          </p>
      </div>
    </div>

<div class="quarto-title-meta">

      
  
    
  </div>
  

</header>

<section id="about-this-tutorial" class="level2">
<h2 class="anchored" data-anchor-id="about-this-tutorial">About this tutorial</h2>
<p>Welcome to this tutorial on data analysis in R!</p>
<p>In this tutorial, <strong>our goal is to review some of the R functions you will need to analyse the data you have collected in the field and answer your research questions</strong>. For this tutorial, we strongly recommend that you reflect on what you have learned in the Statistics GSS course during Period 3. The Statistics GSS course taught you many useful tools for data analysis. Now it’s time to put them into practice on a real ecological data set. For this tutorial, you will be using the same POEM data as in the tutorial on data wrangling. If you don’t remember what these data are, please refer to the first sections of the first tutorial on data wrangling.</p>
<p>Let’s get started!</p>
</section>
<section id="importing-poem-data" class="level2">
<h2 class="anchored" data-anchor-id="importing-poem-data">Importing POEM data</h2>
<p>The first thing to do after opening RStudio is to import the POEM data. This is exactly the same as what we already did in the first tutorial. <u>Try writing the code yourself this time</u> (i.e.&nbsp;without looking too quickly at the solution)!</p>
<section id="download-the-poem-data-from-zenodo" class="level3">
<h3 class="anchored" data-anchor-id="download-the-poem-data-from-zenodo">Download the POEM data from Zenodo</h3>
<p>The POEM data that will be used in this tutorial are available on a <a href="https://zenodo.org/records/10119982">Zenodo repository</a>. You can download the data manually, but you can also do it using an R function called <code>download_zenodo()</code>. Let’s give it a try.</p>
<p>First, install the <em>inborutils</em> R package using the following code:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"inborutils"</span>, </span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>                 <span class="at">repos =</span> <span class="fu">c</span>(<span class="at">inbo =</span> <span class="st">"https://inbo.r-universe.dev"</span>,</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>                           <span class="at">CRAN =</span> <span class="st">"https://cloud.r-project.org"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>You can now download the data used in this tutorial using <code>download_zenodo()</code>.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>inborutils<span class="sc">::</span><span class="fu">download_zenodo</span>(<span class="at">doi=</span><span class="st">"10.5281/zenodo.10119982"</span>,</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>                            <span class="at">quiet=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>By default, the data will be downloaded as a zip file and will be stored in your working directory. If you do not know what is your working directory, run <code>getwd()</code> in your R console. Let’s extract (or unzip) the files we have just downloaded from Zenodo and let’s store these files in a new folder called “Data_POEM”:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">unzip</span>(<span class="at">zipfile =</span> <span class="st">"Data_POEM_Paper1_Alonso-Crespo_et_al_2024-v1.0.zip"</span>,       </span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>      <span class="at">exdir =</span> <span class="st">"Data_POEM"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="load-r-packages" class="level3">
<h3 class="anchored" data-anchor-id="load-r-packages">Load R packages</h3>
<p>Most of the functions we need for the rest of this tutorial are available with base R and in R packages from the <em>tidyverse</em> collection. We will also need the <code>read_excel()</code> function from the <em>readxl</em> package and the <code>kable()</code> function from the <em>knitr</em> package. We will also need functions from the <em>vegan</em>, <em>car</em>, <em>emmeans,</em> and <em>viridis</em> R packages later in this tutorial. If they are not yet installed in your library, install it using <code>install.packages()</code>.</p>
<p>You can load all the packages required for this tutorial using <code>library()</code>.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse) </span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl) </span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(vegan)</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car)</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(emmeans)</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(viridis)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="import-data-into-r" class="level3">
<h3 class="anchored" data-anchor-id="import-data-into-r">Import data into R</h3>
<p>In the POEM project, raw biomass data (measured at the species level) are stored in different folders for the experiment started in 2020 (POEM2020) and the experiment started in 2021 (POEM2021). For each experiment, there is one data file for each growing season. As the data is stored in Excel files (.xlsx), we can use <code>read_excel()</code> to import our data into R. For now, we will simply store each set of data in separate R objects.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Import data from the first experiment (POEM2020)  </span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>poem2020_year1 <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"Data_POEM/POEMexperiment-Data_POEM_Paper1_Alonso-Crespo_et_al_2024-0c2abb7/Data/POEM2020/Data_Biomass_POEM2020_2020-07.xlsx"</span>)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>poem2020_year2 <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"Data_POEM/POEMexperiment-Data_POEM_Paper1_Alonso-Crespo_et_al_2024-0c2abb7/Data/POEM2020/Data_Biomass_POEM2020_2021-06.xlsx"</span>)</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>poem2020_year3 <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"Data_POEM/POEMexperiment-Data_POEM_Paper1_Alonso-Crespo_et_al_2024-0c2abb7/Data/POEM2020/Data_Biomass_POEM2020_2022-06.xlsx"</span>)  </span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="co">#Import data from the second experiment (POEM2021)  </span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>poem2021_year1 <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"Data_POEM/POEMexperiment-Data_POEM_Paper1_Alonso-Crespo_et_al_2024-0c2abb7/Data/POEM2021/Data_Biomass_POEM2021_2021-07.xlsx"</span>)  </span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>poem2021_year2 <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"Data_POEM/POEMexperiment-Data_POEM_Paper1_Alonso-Crespo_et_al_2024-0c2abb7/Data/POEM2021/Data_Biomass_POEM2021_2022-06.xlsx"</span>)  </span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>poem2021_year3 <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"Data_POEM/POEMexperiment-Data_POEM_Paper1_Alonso-Crespo_et_al_2024-0c2abb7/Data/POEM2021/Data_Biomass_POEM2021_2023-06.xlsx"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>In RStudio, you can see how each data frame looks like using <code>View()</code>.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">View</span>(poem2021_year1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>You can see that each dataset consists of a number of observations (rows) of 6 variables (columns). These variables are:</p>
<ul>
<li><strong>Year</strong>: the year of initiation of each experiment</li>
<li><strong>Harvest</strong>: the date at which biomass data were collected (YYYY-MM)</li>
<li><strong>Plot</strong>: the plot identification number (plot number - arrival order/replicate)</li>
<li><strong>Quadrat</strong>: the quadrat identification number (plant biomass was collected in 2 or 4 quadrats per plot)</li>
<li><strong>Species</strong>: the plant species name</li>
<li><strong>SDW_g</strong>: the shoot dry weight in grams</li>
</ul>
<p>To enable data exploration and analysis, we now need to combine these different datasets, so that all the data is stored in the same R object. You can do this using <code>rbind()</code>.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>poem_data <span class="ot">&lt;-</span> <span class="fu">rbind</span>(poem2020_year1,</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>                   poem2020_year2,</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>                   poem2020_year3,</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>                   poem2021_year1,</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>                   poem2021_year2,</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>                   poem2021_year3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="organise-poem-data" class="level2">
<h2 class="anchored" data-anchor-id="organise-poem-data">Organise POEM data</h2>
<p>Write R code to reorganise the data so that we can analyse them. Make sure to do the following:</p>
<ul>
<li><p>Create new columns based on the information contained in the Plot column. This can be done easily using <code>separate_wider_delim()</code> and <code>separate_wider_position()</code>. Make sure to add the following three columns to the dataset:</p>
<ul>
<li>PlotID (the plot number)</li>
<li>Arrival (the order of arrival treatment: S, F, G, L, B)</li>
<li>Replicate (the replicate number)</li>
</ul></li>
<li><p>Make sure that PlotID and Replicate are stored as numerical variables. You can do this by combining <code>mutate()</code> with <code>as.numeric()</code>.</p></li>
<li><p>Finally, rename the column storing plant biomass values (SDW_g). Name it “Biomass”. You can do this using <code>rename()</code>.</p></li>
</ul>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>poem_data <span class="ot">&lt;-</span> poem_data <span class="sc">|&gt;</span> </span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate_wider_delim</span>(<span class="at">cols =</span> Plot,</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>                       <span class="at">delim=</span><span class="st">"-"</span>,</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>                       <span class="at">names=</span><span class="fu">c</span>(<span class="st">"PlotID"</span>, <span class="st">"Treatment"</span>),</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>                       <span class="at">cols_remove=</span><span class="cn">TRUE</span>) <span class="sc">|&gt;</span> </span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate_wider_position</span>(<span class="at">cols =</span> Treatment,</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>                          <span class="at">width=</span><span class="fu">c</span>(<span class="at">Arrival=</span><span class="dv">1</span>, <span class="at">Replicate=</span><span class="dv">1</span>),</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>                          <span class="at">cols_remove=</span><span class="cn">TRUE</span>) <span class="sc">|&gt;</span> </span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">PlotID=</span><span class="fu">as.numeric</span>(PlotID),</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">Replicate=</span><span class="fu">as.numeric</span>(Replicate)) <span class="sc">|&gt;</span> </span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">Biomass=</span>SDW_g)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Let’s take a quick look at the first ten rows of our dataset using <code>head().</code> We can also use <code>kable()</code> in the <em>knitr</em> package to produce a nice looking table in your R console.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(<span class="fu">head</span>(poem_data, <span class="at">n =</span> <span class="dv">10</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 6%">
<col style="width: 10%">
<col style="width: 8%">
<col style="width: 10%">
<col style="width: 12%">
<col style="width: 10%">
<col style="width: 30%">
<col style="width: 10%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: right;">Year</th>
<th style="text-align: left;">Harvest</th>
<th style="text-align: right;">PlotID</th>
<th style="text-align: left;">Arrival</th>
<th style="text-align: right;">Replicate</th>
<th style="text-align: right;">Quadrat</th>
<th style="text-align: left;">Species</th>
<th style="text-align: right;">Biomass</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">2020</td>
<td style="text-align: left;">2020-07</td>
<td style="text-align: right;">101</td>
<td style="text-align: left;">F</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">Agrostis capillaris</td>
<td style="text-align: right;">0.0000</td>
</tr>
<tr class="even">
<td style="text-align: right;">2020</td>
<td style="text-align: left;">2020-07</td>
<td style="text-align: right;">101</td>
<td style="text-align: left;">F</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">Anchusa arvensis</td>
<td style="text-align: right;">0.0000</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2020</td>
<td style="text-align: left;">2020-07</td>
<td style="text-align: right;">101</td>
<td style="text-align: left;">F</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">Anthemis arvensis</td>
<td style="text-align: right;">10.2100</td>
</tr>
<tr class="even">
<td style="text-align: right;">2020</td>
<td style="text-align: left;">2020-07</td>
<td style="text-align: right;">101</td>
<td style="text-align: left;">F</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">Anthoxanthum odoratum</td>
<td style="text-align: right;">0.0000</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2020</td>
<td style="text-align: left;">2020-07</td>
<td style="text-align: right;">101</td>
<td style="text-align: left;">F</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">Arabidopsis thaliana</td>
<td style="text-align: right;">0.0000</td>
</tr>
<tr class="even">
<td style="text-align: right;">2020</td>
<td style="text-align: left;">2020-07</td>
<td style="text-align: right;">101</td>
<td style="text-align: left;">F</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">Bromus hordeaceus</td>
<td style="text-align: right;">0.0000</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2020</td>
<td style="text-align: left;">2020-07</td>
<td style="text-align: right;">101</td>
<td style="text-align: left;">F</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">Capsella bursa-pastoris</td>
<td style="text-align: right;">0.0000</td>
</tr>
<tr class="even">
<td style="text-align: right;">2020</td>
<td style="text-align: left;">2020-07</td>
<td style="text-align: right;">101</td>
<td style="text-align: left;">F</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">Chenopodium album</td>
<td style="text-align: right;">0.7658</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2020</td>
<td style="text-align: left;">2020-07</td>
<td style="text-align: right;">101</td>
<td style="text-align: left;">F</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">Crepis tectorum</td>
<td style="text-align: right;">0.0000</td>
</tr>
<tr class="even">
<td style="text-align: right;">2020</td>
<td style="text-align: left;">2020-07</td>
<td style="text-align: right;">101</td>
<td style="text-align: left;">F</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">Dianthus deltoides</td>
<td style="text-align: right;">0.0000</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="exercise-1-do-plant-order-of-arrival-and-year-of-initiation-of-an-experiment-affect-the-total-aboveground-biomass-production-of-plant-communities" class="level2">
<h2 class="anchored" data-anchor-id="exercise-1-do-plant-order-of-arrival-and-year-of-initiation-of-an-experiment-affect-the-total-aboveground-biomass-production-of-plant-communities">Exercise 1: Do plant order of arrival and year of initiation of an experiment affect the total aboveground biomass production of plant communities?</h2>
<section id="step-1-calculate-the-total-biomass-production-in-each-plot" class="level3">
<h3 class="anchored" data-anchor-id="step-1-calculate-the-total-biomass-production-in-each-plot">Step 1: Calculate the total biomass production in each plot</h3>
<p>Before starting analysing our data, we must first calculate the total biomass production of each plant community at each harvest date. This can be done by summing the biomass value of all species collected in a plot at a given harvest date. Use what you learned in the data wrangling tutorial to write a piece of R code that does that. When writing your code, remember the following:</p>
<ul>
<li><p>Store the dataset in a new object called <code>poem_data_biomass</code>.</p></li>
<li><p>Do not forget to standardise biomass data in g/m². Each quadrat has a surface area of 0.1 m². Use <code>mutate()</code> to add a new column called “Std_biomass” to the dataset.</p></li>
<li><p>Depending on the harvest date, all plant species located within 2 or 4 randomly positioned quadrats were collected in each plot. To obtain a biomass value per species and per plot, it is first necessary to calculate the average biomass value for each species in a plot at each harvest date (i.e., across quadrats). Use <code>group_by()</code> and <code>summarise()</code> to do that.</p></li>
<li><p>Once you have calculated the average biomass value for each species in a plot, use <code>group_by()</code> and <code>summarise()</code> again to calculate the total aboveground biomass in each plot by adding up the yield (in g/m²) of all species in a plot.</p></li>
<li><p>Only keep the data for the second harvest date of each sub-experiment (2021-06 for the experiment initiated in 2020, 2022-06 for the experiment initiated in 2021).</p></li>
</ul>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>poem_data_biomass <span class="ot">&lt;-</span> poem_data <span class="sc">|&gt;</span> </span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Std_biomass=</span>Biomass<span class="sc">/</span><span class="fl">0.1</span>, <span class="co">#Convert to g/m²</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">.after =</span> <span class="st">"Biomass"</span>) <span class="sc">|&gt;</span>  <span class="co">#Specify that we want this new column to be after the Biomass column</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Year, Harvest, PlotID, Arrival, Species) <span class="sc">|&gt;</span> <span class="co">#Define grouping factors in your data</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Std_biomass=</span><span class="fu">mean</span>(Std_biomass)) <span class="sc">|&gt;</span> <span class="co">#Calculates the average productivity of each species in a plot</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Year, Harvest, PlotID, Arrival) <span class="sc">|&gt;</span> <span class="co">#Redefine groups (interested in summing biomass values across species)</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Total_biomass=</span><span class="fu">sum</span>(Std_biomass)) <span class="sc">|&gt;</span>  <span class="co">#Calculate total biomass production in each plot</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>((Year <span class="sc">==</span> <span class="dv">2020</span> <span class="sc">&amp;</span> Harvest <span class="sc">==</span> <span class="st">"2021-06"</span>)<span class="sc">|</span>(Year <span class="sc">==</span> <span class="dv">2021</span> <span class="sc">&amp;</span> Harvest <span class="sc">==</span> <span class="st">"2022-06"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Let’s take a quick look at the first ten rows of our new dataset using <code>head().</code></p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(<span class="fu">head</span>(poem_data_biomass, <span class="at">n =</span> <span class="dv">10</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: right;">Year</th>
<th style="text-align: left;">Harvest</th>
<th style="text-align: right;">PlotID</th>
<th style="text-align: left;">Arrival</th>
<th style="text-align: right;">Total_biomass</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">2020</td>
<td style="text-align: left;">2021-06</td>
<td style="text-align: right;">101</td>
<td style="text-align: left;">F</td>
<td style="text-align: right;">631.5848</td>
</tr>
<tr class="even">
<td style="text-align: right;">2020</td>
<td style="text-align: left;">2021-06</td>
<td style="text-align: right;">102</td>
<td style="text-align: left;">S</td>
<td style="text-align: right;">373.8803</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2020</td>
<td style="text-align: left;">2021-06</td>
<td style="text-align: right;">103</td>
<td style="text-align: left;">L</td>
<td style="text-align: right;">416.4602</td>
</tr>
<tr class="even">
<td style="text-align: right;">2020</td>
<td style="text-align: left;">2021-06</td>
<td style="text-align: right;">104</td>
<td style="text-align: left;">L</td>
<td style="text-align: right;">350.6379</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2020</td>
<td style="text-align: left;">2021-06</td>
<td style="text-align: right;">105</td>
<td style="text-align: left;">G</td>
<td style="text-align: right;">335.7337</td>
</tr>
<tr class="even">
<td style="text-align: right;">2020</td>
<td style="text-align: left;">2021-06</td>
<td style="text-align: right;">106</td>
<td style="text-align: left;">G</td>
<td style="text-align: right;">259.7065</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2020</td>
<td style="text-align: left;">2021-06</td>
<td style="text-align: right;">107</td>
<td style="text-align: left;">S</td>
<td style="text-align: right;">439.7880</td>
</tr>
<tr class="even">
<td style="text-align: right;">2020</td>
<td style="text-align: left;">2021-06</td>
<td style="text-align: right;">108</td>
<td style="text-align: left;">B</td>
<td style="text-align: right;">204.5267</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2020</td>
<td style="text-align: left;">2021-06</td>
<td style="text-align: right;">109</td>
<td style="text-align: left;">S</td>
<td style="text-align: right;">398.8852</td>
</tr>
<tr class="even">
<td style="text-align: right;">2020</td>
<td style="text-align: left;">2021-06</td>
<td style="text-align: right;">110</td>
<td style="text-align: left;">G</td>
<td style="text-align: right;">471.7547</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="step-2-visualise-raw-data" class="level3">
<h3 class="anchored" data-anchor-id="step-2-visualise-raw-data">Step 2: Visualise raw data</h3>
<p>Before fitting a statistical model to our data, let’s first create a plot to help us answer our research question: Do plant order of arrival and year of initiation of an experiment affect the total aboveground biomass production of plant communities?</p>
<p>This research question gives us important information about what needs to be represented. The first half of the question tells us that our graph should present results for all possible combinations of plant arrival order (S, F, G, L, B) and year of initiation (2020 and 2021). These are the fixed factors of the experiment. We can make sure that these columns are correctly interpreted as factors by using <code>factor()</code>. It may also be a good idea to reorder factor levels in a meaningful way (S, F, G, L, B). The second half of the research question tells us that we need to show the differences in total aboveground biomass production between all possible treatment combinations. This is the response variable of our experiment.</p>
<p>Using what you have learned in the previous tutorials, create a high-quality figure that answers the research question. Feel free to personalise your plot in any way you think best communicates the results (you do not necessarily have to produce the same plot as below). What can you already notice from this graph? Does it look like ANOVA (ANalysis Of VAriance)) assumptions are met?</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true" aria-current="page">Solution (code)</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">Solution (plot)</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<div class="cell" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>poem_data_biomass<span class="sc">$</span>Year <span class="ot">&lt;-</span> <span class="fu">factor</span>(poem_data_biomass<span class="sc">$</span>Year)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>poem_data_biomass<span class="sc">$</span>Arrival <span class="ot">&lt;-</span> <span class="fu">factor</span>(poem_data_biomass<span class="sc">$</span>Arrival,</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">levels=</span><span class="fu">c</span>(<span class="st">"S"</span>, <span class="st">"F"</span>, <span class="st">"G"</span>, <span class="st">"L"</span>, <span class="st">"B"</span>))</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>plot <span class="ot">&lt;-</span> poem_data_biomass <span class="sc">|&gt;</span> </span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>          <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>Arrival,</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>                     <span class="at">y=</span>Total_biomass))<span class="sc">+</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>          <span class="fu">facet_grid</span>(<span class="sc">~</span>Year)<span class="sc">+</span></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>          <span class="fu">geom_jitter</span>(<span class="at">height =</span> <span class="dv">0</span>,</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>                      <span class="at">width=</span><span class="fl">0.1</span>,</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>                      <span class="at">shape=</span><span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>          <span class="fu">stat_summary</span>(<span class="at">fun.data =</span> <span class="st">"mean_cl_boot"</span>)<span class="sc">+</span></span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>          <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>          <span class="fu">xlab</span>(<span class="st">"Plant order of arrival"</span>)<span class="sc">+</span></span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>          <span class="fu">ylab</span>(<span class="st">"Total shoot dry weight (g/m²)"</span>)<span class="sc">+</span></span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>          <span class="fu">theme</span>(<span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t=</span><span class="dv">10</span>)),</span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>                <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">r=</span><span class="dv">10</span>)),</span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a>                <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">colour=</span><span class="st">"black"</span>))<span class="sc">+</span></span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a>          <span class="fu">scale_y_continuous</span>(<span class="at">breaks=</span><span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">100</span>,</span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">to =</span> <span class="dv">600</span>,</span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">by =</span> <span class="dv">100</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<div class="cell" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="data_analysis_files/figure-html/unnamed-chunk-13-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="step-3-fit-a-model" class="level3">
<h3 class="anchored" data-anchor-id="step-3-fit-a-model">Step 3: Fit a model</h3>
<p>Let’s fit a statistical model to study the relationship between our response variable of interest (Total_biomass) and our two experimental factors (Year and Arrival). There are different ways to do this in R. First, let’s check whether a <strong><em>simple linear regression model</em></strong> can correctly model our data. We will use the <code>lm()</code> function to fit this linear model (this will give us the same results as the <code>aov()</code> function). Note that each group being compared has 5 independent observations, which is not sufficient to test the assumption that the data are normally distributed at each combination of factor levels.</p>
<p>The syntax to fit a simple linear regression model with two predictor variables in R is as follows:</p>
<p><code>model &lt;- lm(Response ~ Predictor1*Predictor2, data)</code></p>
<p>The asterisks (*) means that we want to take the interaction between predictor variables into account (you then assume that Predictor1 and Predictor2 have non-additive effects on your response variable). Using a plus sign (+) instead of an asterisks would fit a model without considering an interaction between predictors (in that case, you then assume that Predictor1 and Predictor2 have additive effects on your response variable).</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Fit simple linear regression model</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>model1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(Total_biomass <span class="sc">~</span> Year<span class="sc">*</span>Arrival,</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">data =</span> poem_data_biomass)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Before checking model results, let’s first make sure that model assumptions are met. We can check for homoscedasticity by plotting model residuals (i.e., the difference between model predictions and observations) against fitted values (i.e., model predictions). This is called a residual plot. Fitted values can be calculated using <code>predict()</code>. Residuals can be calculated using <code>residuals()</code>. Try to create such a plot using what you have learned in previous tutorials. Do you notice any pattern in this residual plot?</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" role="tab" aria-controls="tabset-2-1" aria-selected="true">Solution (code)</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" role="tab" aria-controls="tabset-2-2" aria-selected="false">Solution (plot)</a></li></ul>
<div class="tab-content">
<div id="tabset-2-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-2-1-tab">
<div class="cell" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>plot <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">predicted =</span> <span class="fu">predict</span>(model1),</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>           <span class="at">residuals =</span> <span class="fu">residuals</span>(model1)) <span class="sc">|&gt;</span> </span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>        <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>predicted,</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">y=</span>residuals))<span class="sc">+</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>,</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>                   <span class="at">colour =</span> <span class="st">"red"</span>,</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>                   <span class="at">linetype =</span> <span class="dv">2</span>)<span class="sc">+</span></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>        <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>        <span class="fu">xlab</span>(<span class="st">"Predicted values"</span>)<span class="sc">+</span></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>        <span class="fu">ylab</span>(<span class="st">"Residuals"</span>)<span class="sc">+</span></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>        <span class="fu">theme</span>(<span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t=</span><span class="dv">10</span>)),</span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>              <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">r=</span><span class="dv">10</span>)),</span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>              <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">colour=</span><span class="st">"black"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-2-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-2-tab">
<div class="cell" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="data_analysis_files/figure-html/unnamed-chunk-16-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
<p>It seems that there is a strong mean - variance relationship in our data (heteroscedasticity), which means that the model we just fitted is not the best option. A better approach is to switch to a <strong><em>generalised linear model</em></strong> (also referred to as GLM). Generalised linear models can be fitted using the <code>glm()</code> function in the <em>stats</em> package. The syntax is exactly the same as for the <code>lm()</code> function, but there is an extra argument to specify: <code>family</code>. The <code>family</code> argument allows you to describe the error distribution and the link function to be used in the model.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Relationship between <code>lm()</code> and <code>glm()</code>
</div>
</div>
<div class="callout-body-container callout-body">
<p>A simple linear regression model (<code>lm()</code>) is a special case of a gaussian generalised linear model with an identity link. This means that</p>
<p><code>lm(Response ~ Predictor1*Predictor2, data)</code></p>
<p>and</p>
<p><code>glm(Response ~ Predictor1*Predictor2, data, family=gaussian(link="identity")</code></p>
<p>produce the same results.</p>
</div>
</div>
<p>Instead of using a gaussian distribution, a gamma distribution can be used for a response variable that is continuous and strictly positive. Negative values and zeros are not allowed with a gamma distribution. This distribution is useful to model variables such as biomass, length, etc. Using a log link function will also help deal with heteroscedasticity. This can be done by writing <code>family=Gamma(link="log")</code> in <code>glm()</code>.</p>
<p>Let’s fit a new model (this time a GLM) to our data.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Fit simple linear regression model</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>model2 <span class="ot">&lt;-</span> <span class="fu">glm</span>(Total_biomass <span class="sc">~</span> Year<span class="sc">*</span>Arrival,</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>              <span class="at">data =</span> poem_data_biomass,</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>              <span class="at">family =</span> <span class="fu">Gamma</span>(<span class="at">link=</span><span class="st">"log"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Before checking model results, let’s first create a residual plot. What do you notice? What’s new in this residual plot?</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-3-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-1" role="tab" aria-controls="tabset-3-1" aria-selected="true">Solution (code)</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-2" role="tab" aria-controls="tabset-3-2" aria-selected="false">Solution (plot)</a></li></ul>
<div class="tab-content">
<div id="tabset-3-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-3-1-tab">
<div class="cell" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>plot <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">predicted =</span> <span class="fu">predict</span>(model2),</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>           <span class="at">residuals =</span> <span class="fu">residuals</span>(model2)) <span class="sc">|&gt;</span> </span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>        <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>predicted,</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">y=</span>residuals))<span class="sc">+</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>,</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>                   <span class="at">colour =</span> <span class="st">"red"</span>,</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>                   <span class="at">linetype =</span> <span class="dv">2</span>)<span class="sc">+</span></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>        <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>        <span class="fu">xlab</span>(<span class="st">"Predicted values"</span>)<span class="sc">+</span></span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>        <span class="fu">ylab</span>(<span class="st">"Pearson residuals"</span>)<span class="sc">+</span></span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>        <span class="fu">theme</span>(<span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t=</span><span class="dv">10</span>)),</span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>              <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">r=</span><span class="dv">10</span>)),</span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a>              <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">colour=</span><span class="st">"black"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-3-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-2-tab">
<div class="cell" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="data_analysis_files/figure-html/unnamed-chunk-19-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
<p>Let’s now take a look at model outputs. You can do this using <code>summary()</code>. This output contains a wealth of useful information. The coefficient table gives you the coefficients of the model. When looking at the results of the statistical tests, it seems that only three to four coefficients in the equation above can be considered significantly different from zero (marked with a dot or an asterisks).</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-4-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-1" role="tab" aria-controls="tabset-4-1" aria-selected="true">Solution (code)</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-2" role="tab" aria-controls="tabset-4-2" aria-selected="false">Solution (output)</a></li></ul>
<div class="tab-content">
<div id="tabset-4-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-4-1-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>output <span class="ot">&lt;-</span> <span class="fu">summary</span>(model2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-4-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-2-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>output</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = Total_biomass ~ Year * Arrival, family = Gamma(link = "log"), 
    data = poem_data_biomass)

Coefficients:
                   Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)        6.004507   0.149202  40.244  &lt; 2e-16 ***
Year2021          -0.329777   0.211003  -1.563 0.125954    
ArrivalF          -0.020715   0.211003  -0.098 0.922284    
ArrivalG           0.009288   0.211003   0.044 0.965110    
ArrivalL          -0.274526   0.211003  -1.301 0.200686    
ArrivalB          -0.892933   0.211003  -4.232 0.000131 ***
Year2021:ArrivalF  0.172509   0.298404   0.578 0.566433    
Year2021:ArrivalG -0.061414   0.298404  -0.206 0.837984    
Year2021:ArrivalL  0.508079   0.298404   1.703 0.096393 .  
Year2021:ArrivalB  0.772812   0.298404   2.590 0.013331 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for Gamma family taken to be 0.1113061)

    Null deviance: 7.7314  on 49  degrees of freedom
Residual deviance: 4.6170  on 40  degrees of freedom
AIC: 615.24

Number of Fisher Scoring iterations: 4</code></pre>
</div>
</div>
</div>
</div>
</div>
<p>GLM models do not return any R² values (like for simple linear regression models). The closest we can get is to calculate the explained deviance:</p>
<p><span class="math display">\[
ExplainedDeviance = 100 \times \frac{NullDeviance - ResidualDeviance}{NullDeviance}
\]</span></p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>null_deviance <span class="ot">&lt;-</span> <span class="fu">summary</span>(model2)<span class="sc">$</span>null.deviance</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>residual_deviance <span class="ot">&lt;-</span> <span class="fu">summary</span>(model2)<span class="sc">$</span>deviance</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>explained_deviance <span class="ot">&lt;-</span> <span class="dv">100</span><span class="sc">*</span>(null_deviance<span class="sc">-</span>residual_deviance)<span class="sc">/</span>null_deviance</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>The explanatory variables included in the model explain 40.3% of the variation in total plant biomass production.</p>
</section>
<section id="step-4-compare-group-means" class="level3">
<h3 class="anchored" data-anchor-id="step-4-compare-group-means">Step 4: Compare group means</h3>
<p>You can use the <code>Anova()</code> function in the <em>car</em> package to produce an ANOVA table (in this case, an analysis of deviance table). This table shows that the two factors of our experiment interact with each other. This means that the effect of plant order of arrival on community biomass depends on the year of initiation of an experiment.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-5-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-1" role="tab" aria-controls="tabset-5-1" aria-selected="true">Solution (code)</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-2" role="tab" aria-controls="tabset-5-2" aria-selected="false">Solution (table)</a></li></ul>
<div class="tab-content">
<div id="tabset-5-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-5-1-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>table <span class="ot">&lt;-</span> <span class="fu">Anova</span>(model2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-5-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-2-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>table</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Deviance Table (Type II tests)

Response: Total_biomass
             LR Chisq Df Pr(&gt;Chisq)   
Year           0.3025  1    0.58229   
Arrival       15.7997  4    0.00330 **
Year:Arrival  11.1856  4    0.02456 * 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
</div>
</div>
</div>
<p>To determine where the differences in community productivity lie between the plant arrival order scenarios for each sub-experiment, we need to perform a posthoc test. The <code>emmeans()</code> function in the <em>emmeans</em> R package is a good option for this. For the <code>emmeans()</code> function, we will need to specify a value for the following arguments:</p>
<ul>
<li><code>object</code> (the object containing the fitted model)</li>
<li><code>specs</code> (a character vector specifying the names of the predictors for which levels must be compared). In this example, this is plant arrival order.</li>
<li><code>by</code> (a character vector specifying the names of the predictors to condition on). In this example, this is the year of initiation of an experiment.</li>
<li><code>contr</code> (a character value specifying the contrasts to be added). We will use pairwise contrasts (i.e., all possible pairs of groups will be compared).</li>
</ul>
<p>To check the results of the posthoc test, we will then call a <code>summary()</code> function on the object produced by <code>emmeans()</code> . In <code>summary()</code>, we will use the <code>type</code> argument to specify that we want model predictions to be on the same scale as the original data (not log scale, but original scale in g/m²).</p>
<p>What can you conclude from this posthoc test?</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-6-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-1" role="tab" aria-controls="tabset-6-1" aria-selected="true">Solution (code)</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-2" role="tab" aria-controls="tabset-6-2" aria-selected="false">Solution (table)</a></li></ul>
<div class="tab-content">
<div id="tabset-6-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-6-1-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>table <span class="ot">&lt;-</span> <span class="fu">summary</span>(<span class="fu">emmeans</span>(<span class="at">object =</span> model2, </span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>                         <span class="at">specs =</span> <span class="st">"Arrival"</span>, </span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>                         <span class="at">by=</span> <span class="st">"Year"</span>,</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>                         <span class="at">contr =</span> <span class="st">"pairwise"</span>), </span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">type=</span><span class="st">"response"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-6-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-2-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>table</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$emmeans
Year = 2020:
 Arrival response   SE df lower.CL upper.CL
 S            405 60.5 40      300      548
 F            397 59.2 40      294      537
 G            409 61.0 40      303      553
 L            308 45.9 40      228      416
 B            166 24.8 40      123      224

Year = 2021:
 Arrival response   SE df lower.CL upper.CL
 S            291 43.5 40      216      394
 F            339 50.6 40      251      459
 G            277 41.3 40      205      374
 L            368 54.9 40      272      498
 B            258 38.6 40      191      349

Confidence level used: 0.95 
Intervals are back-transformed from the log scale 

$contrasts
Year = 2020:
 contrast ratio    SE df null t.ratio p.value
 S / F    1.021 0.215 40    1   0.098  1.0000
 S / G    0.991 0.209 40    1  -0.044  1.0000
 S / L    1.316 0.278 40    1   1.301  0.6921
 S / B    2.442 0.515 40    1   4.232  0.0012
 F / G    0.970 0.205 40    1  -0.142  0.9999
 F / L    1.289 0.272 40    1   1.203  0.7497
 F / B    2.392 0.505 40    1   4.134  0.0016
 G / L    1.328 0.280 40    1   1.345  0.6653
 G / B    2.465 0.520 40    1   4.276  0.0010
 L / B    1.856 0.392 40    1   2.931  0.0418

Year = 2021:
 contrast ratio    SE df null t.ratio p.value
 S / F    0.859 0.181 40    1  -0.719  0.9508
 S / G    1.054 0.222 40    1   0.247  0.9991
 S / L    0.792 0.167 40    1  -1.107  0.8019
 S / B    1.128 0.238 40    1   0.569  0.9788
 F / G    1.226 0.259 40    1   0.966  0.8685
 F / L    0.921 0.194 40    1  -0.387  0.9950
 F / B    1.312 0.277 40    1   1.289  0.6995
 G / L    0.752 0.159 40    1  -1.354  0.6598
 G / B    1.070 0.226 40    1   0.322  0.9976
 L / B    1.424 0.301 40    1   1.676  0.4597

P value adjustment: tukey method for comparing a family of 5 estimates 
Tests are performed on the log scale </code></pre>
</div>
</div>
</div>
</div>
</div>
<p>For the sub-experiment set up in 2020, all plots where seeds were added (S, F, G, L) were on average more productive than free succession plots. Consequently, the observed effect on community productivity does not appear to be due to the manipulation of plant arrival order, but solely to whether or not seeds were sown in the plots at the start of the experiment. In 2021, there is no evidence of any difference in aboveground biomass production between plant arrival order scenarios.</p>
</section>
<section id="step-5-add-posthoc-test-results-to-the-graph" class="level3">
<h3 class="anchored" data-anchor-id="step-5-add-posthoc-test-results-to-the-graph">Step 5: Add posthoc test results to the graph</h3>
<p>We can add posthoc test results to a graph by adding annotations. This is often done by adding letters next to the groups being compared. Groups that do not share a common letter are considered statistically significantly different from each other (p &lt; 0.05). We can easily add these letters to our graph in two steps:</p>
<ul>
<li><p>Start by creating a data frame (called <code>annotations</code> in the code below) that contains all the information that <em>ggplot2</em> needs to add the annotations to your graph. In our example, this data frame should have as many rows as annotations to add to the graph and must contain the following columns:</p>
<ul>
<li><strong>Year</strong>: the year of initiation of an experiment (2020 or 2021). Use the same column name as in <code>poem_data_biomass</code>.</li>
<li><strong>Arrival</strong>: the plant order of arrival (S, F, G, L, B). Use the same column name as in <code>poem_data_biomass</code>.</li>
<li><strong>y</strong>: the vertical coordinates where annotations should be added. You can freely choose the name of this column.</li>
<li><strong>Label</strong>: the annotations to be added to the graph. You can freely choose the name of this column.</li>
</ul></li>
<li><p>Once this is done, add an extra layer to your ggplot object using <code>geom_text()</code>.</p></li>
</ul>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-7-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-1" role="tab" aria-controls="tabset-7-1" aria-selected="true">Solution (code)</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-7-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-2" role="tab" aria-controls="tabset-7-2" aria-selected="false">Solution (plot)</a></li></ul>
<div class="tab-content">
<div id="tabset-7-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-7-1-tab">
<div class="cell" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>annotations <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Year=</span><span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">2020</span>,<span class="dv">2021</span>), <span class="at">each=</span><span class="dv">5</span>),</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>                          <span class="at">Arrival=</span><span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"S"</span>, <span class="st">"F"</span>, <span class="st">"G"</span>, <span class="st">"L"</span>, <span class="st">"B"</span>), <span class="dv">2</span>),</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>                          <span class="at">y=</span><span class="fu">rep</span>(<span class="dv">600</span>, <span class="dv">10</span>),</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>                          <span class="at">Label=</span><span class="fu">c</span>(<span class="st">"a"</span>, <span class="st">"a"</span>, <span class="st">"a"</span>, <span class="st">"a"</span>, <span class="st">"b"</span>, <span class="st">"a"</span>, <span class="st">"a"</span>, <span class="st">"a"</span>, <span class="st">"a"</span>, <span class="st">"a"</span>))</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>plot <span class="ot">&lt;-</span> poem_data_biomass <span class="sc">|&gt;</span> </span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>          <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>Arrival,</span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>                     <span class="at">y=</span>Total_biomass))<span class="sc">+</span></span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>          <span class="fu">facet_grid</span>(<span class="sc">~</span>Year)<span class="sc">+</span></span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>          <span class="fu">geom_jitter</span>(<span class="at">height =</span> <span class="dv">0</span>,</span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a>                      <span class="at">width=</span><span class="fl">0.1</span>,</span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a>                      <span class="at">shape=</span><span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a>          <span class="fu">stat_summary</span>(<span class="at">fun.data =</span> <span class="st">"mean_cl_boot"</span>)<span class="sc">+</span></span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a>          <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a>          <span class="fu">xlab</span>(<span class="st">"Plant order of arrival"</span>)<span class="sc">+</span></span>
<span id="cb30-16"><a href="#cb30-16" aria-hidden="true" tabindex="-1"></a>          <span class="fu">ylab</span>(<span class="st">"Total shoot dry weight (g/m²)"</span>)<span class="sc">+</span></span>
<span id="cb30-17"><a href="#cb30-17" aria-hidden="true" tabindex="-1"></a>          <span class="fu">theme</span>(<span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t=</span><span class="dv">10</span>)),</span>
<span id="cb30-18"><a href="#cb30-18" aria-hidden="true" tabindex="-1"></a>                <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">r=</span><span class="dv">10</span>)),</span>
<span id="cb30-19"><a href="#cb30-19" aria-hidden="true" tabindex="-1"></a>                <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">colour=</span><span class="st">"black"</span>))<span class="sc">+</span></span>
<span id="cb30-20"><a href="#cb30-20" aria-hidden="true" tabindex="-1"></a>          <span class="fu">scale_y_continuous</span>(<span class="at">breaks=</span><span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">100</span>,</span>
<span id="cb30-21"><a href="#cb30-21" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">to =</span> <span class="dv">600</span>,</span>
<span id="cb30-22"><a href="#cb30-22" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">by =</span> <span class="dv">100</span>))<span class="sc">+</span></span>
<span id="cb30-23"><a href="#cb30-23" aria-hidden="true" tabindex="-1"></a>          <span class="fu">geom_text</span>(<span class="at">data=</span>annotations,</span>
<span id="cb30-24"><a href="#cb30-24" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">aes</span>(<span class="at">x=</span>Arrival,</span>
<span id="cb30-25"><a href="#cb30-25" aria-hidden="true" tabindex="-1"></a>                        <span class="at">y=</span>y,</span>
<span id="cb30-26"><a href="#cb30-26" aria-hidden="true" tabindex="-1"></a>                        <span class="at">label=</span>Label))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-7-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-7-2-tab">
<div class="cell" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="data_analysis_files/figure-html/unnamed-chunk-28-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="exercise-2-non-metric-multidimensional-scaling" class="level2">
<h2 class="anchored" data-anchor-id="exercise-2-non-metric-multidimensional-scaling">Exercise 2: Non-metric multidimensional scaling</h2>
<section id="step-1-choose-a-measure-of-association" class="level3">
<h3 class="anchored" data-anchor-id="step-1-choose-a-measure-of-association">Step 1: Choose a measure of association</h3>
<p><strong>Non-metric multidimensional scaling</strong> (NMDS) is a technique often used in ecological research to visualise differences (or (dis)similarities) in species composition between ecological communities.</p>
<p>The first step is to choose a measure of association and calculate a dissimilarity matrix. This dissimilarity matrix will have as many rows and columns as ecological communities to be compared. The help page of the <code>vegdist()</code> function of the <em>vegan</em> package lists a number of dissimilarity indices for ecologists wishing to quantify dissimilarity in species composition between communities. You can access this help page by running <code>?vegdist</code> in your R console (a detailed discussion of the advantages and disadvantages of each dissimilarity index is beyond the scope of this tutorial). The Bray-Curtis dissimilarity is usually good at detecting ecological gradients (see <code>?vegdist</code>) and is often used as default when performing NMDS. This is the dissimilarity index we are going to use in this tutorial too.</p>
</section>
<section id="step-2-organise-your-data" class="level3">
<h3 class="anchored" data-anchor-id="step-2-organise-your-data">Step 2: Organise your data</h3>
<p>To obtain the dissimilarity matrix required for NMDS, we first need to reorganise our data so that each species has its own column and each ecological community has its own row (i.e., a site-by-species matrix). Use the <code>poem_data</code> object as a starting point. In your code, include the following steps:</p>
<ul>
<li>Store the dataset in a new object called <code>poem_data_wide</code>.</li>
<li>Standardise biomass data in g/m². Each quadrat has a surface area of 0.1 m². Use <code>mutate()</code> to add a new column called “Std_biomass” to the dataset.</li>
<li>Depending on the harvest date, all plant species located within 2 or 4 randomly positioned quadrats were collected in each plot. To obtain a biomass value per species and per plot, it is first necessary to calculate the average biomass value for each species in a plot at each harvest date (i.e., across quadrats). Use <code>group_by()</code> and <code>summarise()</code> to do that.</li>
<li>Use <code>pivot_wider()</code> to reorganise your data (one column per species).</li>
<li>Only keep the data for the second harvest date of each sub-experiment (2021-06 for the experiment initiated in 2020, 2022-06 for the experiment initiated in 2021).</li>
<li>Remove all species columns that only contain zeros. You can do this using <code>select(where( ~ is.numeric(.x) &amp;&amp; sum(.x) != 0))</code>.</li>
<li>Remove the column named “Unknown”.</li>
</ul>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>poem_data_wide <span class="ot">&lt;-</span> poem_data <span class="sc">|&gt;</span> </span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Std_biomass=</span>Biomass<span class="sc">/</span><span class="fl">0.1</span>, <span class="co">#Convert to g/m²</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">.after =</span> <span class="st">"Biomass"</span>) <span class="sc">|&gt;</span>  <span class="co">#Specify that we want this new column to be after the Biomass column</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Year, Harvest, PlotID, Arrival, Species) <span class="sc">|&gt;</span> <span class="co">#Define grouping factors in your data</span></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Std_biomass=</span><span class="fu">mean</span>(Std_biomass)) <span class="sc">|&gt;</span> </span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> Species, <span class="co">#Species names will be used as column names</span></span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>              <span class="at">values_from =</span> Std_biomass, <span class="co">#Biomass values are stored in the Std_biomass column</span></span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>              <span class="at">values_fill =</span> <span class="dv">0</span>, <span class="co">#If a species is absent in a plot, its biomass value is zero</span></span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>              <span class="at">values_fn =</span> sum) <span class="sc">|&gt;</span>  <span class="co">#Sum biomass values measured on the same species and in the same quadrat</span></span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>((Year <span class="sc">==</span> <span class="dv">2020</span> <span class="sc">&amp;</span> Harvest <span class="sc">==</span> <span class="st">"2021-06"</span>)<span class="sc">|</span>(Year <span class="sc">==</span> <span class="dv">2021</span> <span class="sc">&amp;</span> Harvest <span class="sc">==</span> <span class="st">"2022-06"</span>)) <span class="sc">|&gt;</span>  <span class="co">#Filter data</span></span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">where</span>( <span class="sc">~</span> <span class="fu">is.numeric</span>(.x) <span class="sc">&amp;&amp;</span> <span class="fu">sum</span>(.x) <span class="sc">!=</span> <span class="dv">0</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>Unknown)</span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(<span class="fu">head</span>(poem_data_wide, <span class="dv">10</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 0%">
<col style="width: 0%">
<col style="width: 0%">
<col style="width: 0%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 1%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 1%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 1%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 2%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 2%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 1%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Harvest</th>
<th style="text-align: left;">Arrival</th>
<th style="text-align: right;">Year</th>
<th style="text-align: right;">PlotID</th>
<th style="text-align: right;">Agrostis capillaris</th>
<th style="text-align: right;">Anchusa arvensis</th>
<th style="text-align: right;">Anthemis arvensis</th>
<th style="text-align: right;">Anthoxanthum odoratum</th>
<th style="text-align: right;">Arabidopsis thaliana</th>
<th style="text-align: right;">Bromus hordeaceus</th>
<th style="text-align: right;">Capsella bursa-pastoris</th>
<th style="text-align: right;">Chenopodium album</th>
<th style="text-align: right;">Crepis tectorum</th>
<th style="text-align: right;">Dianthus deltoides</th>
<th style="text-align: right;">Erodium cicutarium</th>
<th style="text-align: right;">Fallopia convolvulus</th>
<th style="text-align: right;">Festuca ovina</th>
<th style="text-align: right;">Jasione montana</th>
<th style="text-align: right;">Lathyrus pratensis</th>
<th style="text-align: right;">Lotus corniculatus</th>
<th style="text-align: right;">Papaver rhoeas</th>
<th style="text-align: right;">Pilosella officinarum</th>
<th style="text-align: right;">Pimpinella saxifraga</th>
<th style="text-align: right;">Polygonum aviculare</th>
<th style="text-align: right;">Potentilla argentea</th>
<th style="text-align: right;">Silene vulgaris</th>
<th style="text-align: right;">Spergula arvensis</th>
<th style="text-align: right;">Trifolium arvense</th>
<th style="text-align: right;">Trifolium campestre</th>
<th style="text-align: right;">Trifolium pratense</th>
<th style="text-align: right;">Vicia sativa</th>
<th style="text-align: right;">Viola arvensis</th>
<th style="text-align: right;">Arenaria serpyllifolia</th>
<th style="text-align: right;">Conyza canadensis</th>
<th style="text-align: right;">Rumex acetosella</th>
<th style="text-align: right;">Apera spica-venti</th>
<th style="text-align: right;">Trifolium repens</th>
<th style="text-align: right;">Veronica arvensis</th>
<th style="text-align: right;">Poa trivialis</th>
<th style="text-align: right;">Vulpia myuros</th>
<th style="text-align: right;">Geranium pusillum</th>
<th style="text-align: right;">Elymus repens</th>
<th style="text-align: right;">Stellaria media</th>
<th style="text-align: right;">Linum sp</th>
<th style="text-align: right;">Ornithopus perpusillus</th>
<th style="text-align: right;">Festuca rubra</th>
<th style="text-align: right;">Festulolium</th>
<th style="text-align: right;">Vicia angustifolia</th>
<th style="text-align: right;">Hypochaeris radicata</th>
<th style="text-align: right;">Vicia hirsuta</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">2021-06</td>
<td style="text-align: left;">F</td>
<td style="text-align: right;">2020</td>
<td style="text-align: right;">101</td>
<td style="text-align: right;">7.3000</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">5.00000</td>
<td style="text-align: right;">0.00000</td>
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">253.50</td>
<td style="text-align: right;">8.90</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">14.3000</td>
<td style="text-align: right;">44.00000</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0984</td>
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">4.566667</td>
<td style="text-align: right;">1.93925</td>
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">1.331933</td>
<td style="text-align: right;">246.2</td>
<td style="text-align: right;">0.1031</td>
<td style="text-align: right;">31.7000</td>
<td style="text-align: right;">3.00000</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">4.84495</td>
<td style="text-align: right;">4.80055</td>
<td style="text-align: right;">0.00000</td>
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">2021-06</td>
<td style="text-align: left;">S</td>
<td style="text-align: right;">2020</td>
<td style="text-align: right;">102</td>
<td style="text-align: right;">29.6000</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.50800</td>
<td style="text-align: right;">56.90000</td>
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">262.80</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">0.4003</td>
<td style="text-align: right;">3.77825</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.7526</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">3.3500</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">2.250000</td>
<td style="text-align: right;">0.26000</td>
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">0.250400</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">0.00000</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1.50000</td>
<td style="text-align: right;">0.53075</td>
<td style="text-align: right;">11.00000</td>
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">2021-06</td>
<td style="text-align: left;">L</td>
<td style="text-align: right;">2020</td>
<td style="text-align: right;">103</td>
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">6.25000</td>
<td style="text-align: right;">12.81635</td>
<td style="text-align: right;">5.4000</td>
<td style="text-align: right;">321.40</td>
<td style="text-align: right;">29.20</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">0.00000</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">13.5500</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.117500</td>
<td style="text-align: right;">0.55970</td>
<td style="text-align: right;">0.0661</td>
<td style="text-align: right;">0.000000</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">8.55000</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.00000</td>
<td style="text-align: right;">2.60000</td>
<td style="text-align: right;">15.09225</td>
<td style="text-align: right;">0.7130</td>
<td style="text-align: right;">0.1453</td>
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">2021-06</td>
<td style="text-align: left;">L</td>
<td style="text-align: right;">2020</td>
<td style="text-align: right;">104</td>
<td style="text-align: right;">11.5000</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">11.20000</td>
<td style="text-align: right;">3.90000</td>
<td style="text-align: right;">3.2000</td>
<td style="text-align: right;">205.75</td>
<td style="text-align: right;">14.55</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">27.4000</td>
<td style="text-align: right;">10.80000</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">14.2</td>
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">16.1000</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">9.700000</td>
<td style="text-align: right;">0.00000</td>
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">0.302700</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">1.2590</td>
<td style="text-align: right;">1.95585</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">8.70000</td>
<td style="text-align: right;">9.30000</td>
<td style="text-align: right;">0.00000</td>
<td style="text-align: right;">0.8204</td>
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">2021-06</td>
<td style="text-align: left;">G</td>
<td style="text-align: right;">2020</td>
<td style="text-align: right;">105</td>
<td style="text-align: right;">0.3735</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.60900</td>
<td style="text-align: right;">15.70000</td>
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">301.55</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">0.00000</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">8.2</td>
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.000000</td>
<td style="text-align: right;">0.00000</td>
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">0.036000</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">7.7500</td>
<td style="text-align: right;">0.13525</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.00000</td>
<td style="text-align: right;">0.90095</td>
<td style="text-align: right;">0.00000</td>
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">0.4790</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">2021-06</td>
<td style="text-align: left;">G</td>
<td style="text-align: right;">2020</td>
<td style="text-align: right;">106</td>
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">9.46700</td>
<td style="text-align: right;">0.00000</td>
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">209.45</td>
<td style="text-align: right;">2.20</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">11.9000</td>
<td style="text-align: right;">7.00000</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.000000</td>
<td style="text-align: right;">0.00000</td>
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">0.000000</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">6.6500</td>
<td style="text-align: right;">1.20000</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1.40000</td>
<td style="text-align: right;">2.33950</td>
<td style="text-align: right;">0.00000</td>
<td style="text-align: right;">2.4000</td>
<td style="text-align: right;">5.7000</td>
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">2021-06</td>
<td style="text-align: left;">S</td>
<td style="text-align: right;">2020</td>
<td style="text-align: right;">107</td>
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.87540</td>
<td style="text-align: right;">0.00000</td>
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">400.55</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">2.0000</td>
<td style="text-align: right;">5.60000</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">3.3000</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">2.400000</td>
<td style="text-align: right;">0.00000</td>
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">0.433800</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">0.3664</td>
<td style="text-align: right;">0.63350</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">14.00000</td>
<td style="text-align: right;">0.22890</td>
<td style="text-align: right;">8.40000</td>
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">2021-06</td>
<td style="text-align: left;">B</td>
<td style="text-align: right;">2020</td>
<td style="text-align: right;">108</td>
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">23.80000</td>
<td style="text-align: right;">0.00000</td>
<td style="text-align: right;">2.0489</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">27.80</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">4.6131</td>
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">79.15000</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.000000</td>
<td style="text-align: right;">0.00000</td>
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">0.000000</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">0.00000</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">3.91470</td>
<td style="text-align: right;">21.30000</td>
<td style="text-align: right;">0.00000</td>
<td style="text-align: right;">32.2000</td>
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">9.7</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">2021-06</td>
<td style="text-align: left;">S</td>
<td style="text-align: right;">2020</td>
<td style="text-align: right;">109</td>
<td style="text-align: right;">1.5000</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1.18325</td>
<td style="text-align: right;">16.25000</td>
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">336.65</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">17.9000</td>
<td style="text-align: right;">16.10000</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">1.2000</td>
<td style="text-align: right;">0.6069</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">5.300000</td>
<td style="text-align: right;">0.00000</td>
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">0.000000</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">0.1882</td>
<td style="text-align: right;">1.34215</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.00000</td>
<td style="text-align: right;">0.41965</td>
<td style="text-align: right;">0.00000</td>
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">0.2451</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">2021-06</td>
<td style="text-align: left;">G</td>
<td style="text-align: right;">2020</td>
<td style="text-align: right;">110</td>
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">5.70000</td>
<td style="text-align: right;">33.80000</td>
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">148.90</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">1.1047</td>
<td style="text-align: right;">0.00000</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">2.7</td>
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1.800000</td>
<td style="text-align: right;">0.00000</td>
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">0.000000</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">33.1000</td>
<td style="text-align: right;">0.00000</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.00000</td>
<td style="text-align: right;">0.00000</td>
<td style="text-align: right;">244.65000</td>
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="step-3-perform-the-nmds" class="level3">
<h3 class="anchored" data-anchor-id="step-3-perform-the-nmds">Step 3: Perform the NMDS</h3>
<p>Now that our community dataset has the right format, we can perform the NMDS using the <code>metaMDS()</code> function of the <em>vegan</em> package. The following arguments are of particular importance:</p>
<ul>
<li><code>comm</code>: the community data (only select the species columns).</li>
<li><code>distance</code>: a character value for the dissimilarity index used. Use “bray” for the Bray-Curtis dissimilarity index.</li>
<li><code>k</code>: the number of dimensions to compute. Let’s start with <code>k=2</code> (we want to produce a 2D plot).</li>
<li><code>trymax</code>: the maximum number of random starts in search of a stable solution. The NMDS algorithm iteratively searches for a stable solution (numerical optimisation methods). Increasing the value of this argument can help reaching a stable solution.</li>
</ul>
<p>We will keep the default values for all other arguments. Store the results in an object named <code>nmds</code>. Do not forget to set a seed (using <code>set.seed()</code> for reproducibility).</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>nmds <span class="ot">&lt;-</span> <span class="fu">metaMDS</span>(<span class="at">comm =</span> poem_data_wide[,<span class="dv">5</span><span class="sc">:</span><span class="fu">ncol</span>(poem_data_wide)],</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">distance =</span> <span class="st">"bray"</span>,</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">k =</span> <span class="dv">2</span>,</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>                <span class="at">trymax =</span> <span class="dv">100</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Square root transformation
Wisconsin double standardization
Run 0 stress 0.2103123 
Run 1 stress 0.2225185 
Run 2 stress 0.2086932 
... New best solution
... Procrustes: rmse 0.02863503  max resid 0.1864024 
Run 3 stress 0.2509824 
Run 4 stress 0.210449 
Run 5 stress 0.2104498 
Run 6 stress 0.2552625 
Run 7 stress 0.2103394 
Run 8 stress 0.2226058 
Run 9 stress 0.2220444 
Run 10 stress 0.2636632 
Run 11 stress 0.2103396 
Run 12 stress 0.2337635 
Run 13 stress 0.2229786 
Run 14 stress 0.2354423 
Run 15 stress 0.2219776 
Run 16 stress 0.2104461 
Run 17 stress 0.2229783 
Run 18 stress 0.2109497 
Run 19 stress 0.222518 
Run 20 stress 0.2219777 
Run 21 stress 0.2363447 
Run 22 stress 0.2280337 
Run 23 stress 0.2087741 
... Procrustes: rmse 0.009543295  max resid 0.04393401 
Run 24 stress 0.2581299 
Run 25 stress 0.2104164 
Run 26 stress 0.2627097 
Run 27 stress 0.2222581 
Run 28 stress 0.2090234 
... Procrustes: rmse 0.01461394  max resid 0.07945518 
Run 29 stress 0.2103395 
Run 30 stress 0.2219775 
Run 31 stress 0.2109493 
Run 32 stress 0.2374803 
Run 33 stress 0.2104491 
Run 34 stress 0.2224968 
Run 35 stress 0.2351911 
Run 36 stress 0.2413003 
Run 37 stress 0.2087444 
... Procrustes: rmse 0.005570727  max resid 0.02479952 
Run 38 stress 0.2103123 
Run 39 stress 0.222258 
Run 40 stress 0.2256584 
Run 41 stress 0.2283091 
Run 42 stress 0.210313 
Run 43 stress 0.240405 
Run 44 stress 0.2103395 
Run 45 stress 0.2091079 
... Procrustes: rmse 0.01506522  max resid 0.07917855 
Run 46 stress 0.2219779 
Run 47 stress 0.2104462 
Run 48 stress 0.2104462 
Run 49 stress 0.2103394 
Run 50 stress 0.2090233 
... Procrustes: rmse 0.01461121  max resid 0.07946946 
Run 51 stress 0.2458039 
Run 52 stress 0.2390875 
Run 53 stress 0.208994 
... Procrustes: rmse 0.01166985  max resid 0.07846166 
Run 54 stress 0.2103394 
Run 55 stress 0.2086931 
... New best solution
... Procrustes: rmse 4.166265e-05  max resid 0.0001793574 
... Similar to previous best
*** Best solution repeated 1 times</code></pre>
</div>
</div>
</section>
<section id="step-4-check-nmds-results" class="level3">
<h3 class="anchored" data-anchor-id="step-4-check-nmds-results">Step 4: Check NMDS results</h3>
<p>The main goal of NMDS is to visualise a dissimilarity matrix in a lower (typically 2D) dimensional space. Contrary to principal coordinate analysis (PCoA), which aims to create a plot in which distances between points match the original dissimilarities as closely as possible, NMDS focuses on representing the order, or ranking, of the original dissimilarities as closely as possible (Zuur AF, Ieno EN, Smith GM. 2007. <em>Analysing ecological data</em>. Springer.).</p>
<p>The first way to assess the quality of the display is to look at a parameter called “stress”. You can extract it from the <code>nmds</code> object created earlier using <code>nmds$stress</code>. In our example, the stress value is equal to 0.209. Zuur et al (2007) provided some guidelines on how to interpret stress values (usually, the lower the stress value, the better):</p>
<ul>
<li>stress &lt; 0.05: Excellent configuration</li>
<li>stress between 0.05 and 0.1: Good configuration</li>
<li>stress between 0.1 and 0.2: Be careful with interpretation</li>
<li>stress between 0.2 and 0.3: Problems start. Consider increasing the number of dimensions (<code>k</code>).</li>
<li>stress above 0.3: Poor representation. Increase the number of dimensions (<code>k</code>).</li>
</ul>
<p>Another way to assess the quality of the configuration is to create a Shepard plot. A Shepard plot shows the relationship between ordination distances (i.e., distances in the configuration produced by the NMDS) and original distances. You can produce a Shepard plot using the <code>stressplot()</code> function in <em>vegan</em>. What can you conclude from this Shepard plot?</p>
<div class="cell" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">stressplot</span>(nmds)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="data_analysis_files/figure-html/unnamed-chunk-31-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="step-5-visualise-nmds-results" class="level3">
<h3 class="anchored" data-anchor-id="step-5-visualise-nmds-results">Step 5: Visualise NMDS results</h3>
<p>NMDS results are stored in our <code>nmds</code> object. You can extract the coordinates of each community using <code>nmds$points</code>. To make it easier to work with <em>ggplot2</em>, we will create a new data frame (<code>data_nmds</code>) by merging the first four columns of <code>poem_data_wide</code> (Harvest, Arrival, Year, PlotID) with NMDS results.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>data_nmds <span class="ot">&lt;-</span> <span class="fu">cbind</span>(poem_data_wide[, <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>], nmds<span class="sc">$</span>points)</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(<span class="fu">head</span>(data_nmds, <span class="dv">10</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">Harvest</th>
<th style="text-align: left;">Arrival</th>
<th style="text-align: right;">Year</th>
<th style="text-align: right;">PlotID</th>
<th style="text-align: right;">MDS1</th>
<th style="text-align: right;">MDS2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">2021-06</td>
<td style="text-align: left;">F</td>
<td style="text-align: right;">2020</td>
<td style="text-align: right;">101</td>
<td style="text-align: right;">-0.1463092</td>
<td style="text-align: right;">-0.0254317</td>
</tr>
<tr class="even">
<td style="text-align: left;">2021-06</td>
<td style="text-align: left;">S</td>
<td style="text-align: right;">2020</td>
<td style="text-align: right;">102</td>
<td style="text-align: right;">0.3418738</td>
<td style="text-align: right;">-0.2072966</td>
</tr>
<tr class="odd">
<td style="text-align: left;">2021-06</td>
<td style="text-align: left;">L</td>
<td style="text-align: right;">2020</td>
<td style="text-align: right;">103</td>
<td style="text-align: right;">-0.2407418</td>
<td style="text-align: right;">-0.5973680</td>
</tr>
<tr class="even">
<td style="text-align: left;">2021-06</td>
<td style="text-align: left;">L</td>
<td style="text-align: right;">2020</td>
<td style="text-align: right;">104</td>
<td style="text-align: right;">-0.1856995</td>
<td style="text-align: right;">-0.1114923</td>
</tr>
<tr class="odd">
<td style="text-align: left;">2021-06</td>
<td style="text-align: left;">G</td>
<td style="text-align: right;">2020</td>
<td style="text-align: right;">105</td>
<td style="text-align: right;">0.3549170</td>
<td style="text-align: right;">-0.2867803</td>
</tr>
<tr class="even">
<td style="text-align: left;">2021-06</td>
<td style="text-align: left;">G</td>
<td style="text-align: right;">2020</td>
<td style="text-align: right;">106</td>
<td style="text-align: right;">-0.2967318</td>
<td style="text-align: right;">-0.1615261</td>
</tr>
<tr class="odd">
<td style="text-align: left;">2021-06</td>
<td style="text-align: left;">S</td>
<td style="text-align: right;">2020</td>
<td style="text-align: right;">107</td>
<td style="text-align: right;">0.0230188</td>
<td style="text-align: right;">-0.6151312</td>
</tr>
<tr class="even">
<td style="text-align: left;">2021-06</td>
<td style="text-align: left;">B</td>
<td style="text-align: right;">2020</td>
<td style="text-align: right;">108</td>
<td style="text-align: right;">-0.9473589</td>
<td style="text-align: right;">-0.0703046</td>
</tr>
<tr class="odd">
<td style="text-align: left;">2021-06</td>
<td style="text-align: left;">S</td>
<td style="text-align: right;">2020</td>
<td style="text-align: right;">109</td>
<td style="text-align: right;">0.2143886</td>
<td style="text-align: right;">-0.3983394</td>
</tr>
<tr class="even">
<td style="text-align: left;">2021-06</td>
<td style="text-align: left;">G</td>
<td style="text-align: right;">2020</td>
<td style="text-align: right;">110</td>
<td style="text-align: right;">0.5405956</td>
<td style="text-align: right;">-0.3388275</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>We now have everything we need to plot the results of the NMDS using <em>ggplot2</em>:</p>
<ul>
<li>Create a plot displaying MDS1 on the horizontal axis and MDS2 on the vertical axis.</li>
<li>Use a specific colour for each plant order of arrival scenario (mind colour-blind people!).</li>
<li>Use a specific shape for each year of initiation.</li>
<li>Add an informative legend to your graph.</li>
<li>Add an annotation on the top left corner of your graph for the stress value. Use <code>geom_text()</code> to do that.</li>
</ul>
<p>What can you conclude from this NMDS?</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-8-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-1" role="tab" aria-controls="tabset-8-1" aria-selected="true">Solution (code)</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-8-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-2" role="tab" aria-controls="tabset-8-2" aria-selected="false">Solution (plot)</a></li></ul>
<div class="tab-content">
<div id="tabset-8-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-8-1-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Make sure that Arrival and Year are factors</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>data_nmds<span class="sc">$</span>Arrival <span class="ot">&lt;-</span> <span class="fu">factor</span>(data_nmds<span class="sc">$</span>Arrival,</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>                            <span class="at">levels=</span><span class="fu">c</span>(<span class="st">"S"</span>, <span class="st">"F"</span>, <span class="st">"G"</span>, <span class="st">"L"</span>, <span class="st">"B"</span>))</span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>data_nmds<span class="sc">$</span>Year <span class="ot">&lt;-</span> <span class="fu">factor</span>(data_nmds<span class="sc">$</span>Year,</span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>                         <span class="at">levels=</span><span class="fu">c</span>(<span class="st">"2020"</span>, <span class="st">"2021"</span>))</span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a><span class="co">#Plot results</span></span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a>plot <span class="ot">&lt;-</span> data_nmds <span class="sc">|&gt;</span> </span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> MDS1,</span>
<span id="cb37-13"><a href="#cb37-13" aria-hidden="true" tabindex="-1"></a>             <span class="at">y =</span> MDS2,</span>
<span id="cb37-14"><a href="#cb37-14" aria-hidden="true" tabindex="-1"></a>             <span class="at">colour =</span> Arrival,</span>
<span id="cb37-15"><a href="#cb37-15" aria-hidden="true" tabindex="-1"></a>             <span class="at">shape =</span> Year))<span class="sc">+</span></span>
<span id="cb37-16"><a href="#cb37-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size=</span><span class="dv">2</span>)<span class="sc">+</span></span>
<span id="cb37-17"><a href="#cb37-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb37-18"><a href="#cb37-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_colour_viridis</span>(<span class="at">name =</span> <span class="st">"Plant order of arrival"</span>,</span>
<span id="cb37-19"><a href="#cb37-19" aria-hidden="true" tabindex="-1"></a>                       <span class="at">discrete =</span> <span class="cn">TRUE</span>,</span>
<span id="cb37-20"><a href="#cb37-20" aria-hidden="true" tabindex="-1"></a>                       <span class="at">option =</span> <span class="st">"D"</span>)<span class="sc">+</span></span>
<span id="cb37-21"><a href="#cb37-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="at">name =</span> <span class="st">"Year of initiation"</span>,</span>
<span id="cb37-22"><a href="#cb37-22" aria-hidden="true" tabindex="-1"></a>                     <span class="at">values =</span> <span class="fu">c</span>(<span class="dv">16</span>, <span class="dv">17</span>))<span class="sc">+</span></span>
<span id="cb37-23"><a href="#cb37-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">colour=</span><span class="st">"black"</span>),</span>
<span id="cb37-24"><a href="#cb37-24" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t=</span><span class="dv">10</span>)),</span>
<span id="cb37-25"><a href="#cb37-25" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">r=</span><span class="dv">10</span>)))<span class="sc">+</span></span>
<span id="cb37-26"><a href="#cb37-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"NMDS1"</span>)<span class="sc">+</span></span>
<span id="cb37-27"><a href="#cb37-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"NMDS2"</span>)<span class="sc">+</span></span>
<span id="cb37-28"><a href="#cb37-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data=</span><span class="fu">data.frame</span>(<span class="at">x=</span><span class="fu">min</span>(data_nmds<span class="sc">$</span>MDS1),</span>
<span id="cb37-29"><a href="#cb37-29" aria-hidden="true" tabindex="-1"></a>                            <span class="at">y=</span><span class="fu">max</span>(data_nmds<span class="sc">$</span>MDS2),</span>
<span id="cb37-30"><a href="#cb37-30" aria-hidden="true" tabindex="-1"></a>                            <span class="at">label=</span><span class="fu">paste</span>(<span class="st">"Stress = "</span>, </span>
<span id="cb37-31"><a href="#cb37-31" aria-hidden="true" tabindex="-1"></a>                                        <span class="fu">round</span>(nmds<span class="sc">$</span>stress, <span class="dv">3</span>), </span>
<span id="cb37-32"><a href="#cb37-32" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">sep=</span><span class="st">""</span>)), </span>
<span id="cb37-33"><a href="#cb37-33" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">x =</span> x, </span>
<span id="cb37-34"><a href="#cb37-34" aria-hidden="true" tabindex="-1"></a>                <span class="at">y =</span> y, </span>
<span id="cb37-35"><a href="#cb37-35" aria-hidden="true" tabindex="-1"></a>                <span class="at">label =</span> label),</span>
<span id="cb37-36"><a href="#cb37-36" aria-hidden="true" tabindex="-1"></a>            <span class="at">hjust =</span> <span class="fl">0.1</span>, </span>
<span id="cb37-37"><a href="#cb37-37" aria-hidden="true" tabindex="-1"></a>            <span class="at">vjust =</span> <span class="dv">0</span>, </span>
<span id="cb37-38"><a href="#cb37-38" aria-hidden="true" tabindex="-1"></a>            <span class="at">inherit.aes =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-8-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-8-2-tab">
<div class="cell" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="data_analysis_files/figure-html/unnamed-chunk-34-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
</div>


<!-- -->

</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./data_exploration.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Data exploration</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./contact.html" class="pagination-link">
        <span class="nav-page-text">Contact</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb40" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Tutorial 5: Data analysis in R"</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a><span class="an">author:</span></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a><span class="co">  - name: Benjamin Delory</span></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a><span class="co">    orcid: 0000-0002-1190-8060</span></span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a><span class="co">    email: b.m.m.delory@uu.nl</span></span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a><span class="co">    affiliations:</span></span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a><span class="co">      - name: Environmental sciences group, Copernicus institute of sustainable development, Utrecht University</span></span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a><span class="fu">## About this tutorial</span></span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-13"><a href="#cb40-13" aria-hidden="true" tabindex="-1"></a>Welcome to this tutorial on data analysis in R!</span>
<span id="cb40-14"><a href="#cb40-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-15"><a href="#cb40-15" aria-hidden="true" tabindex="-1"></a>In this tutorial, **our goal is to review some of the R functions you will need to analyse the data you have collected in the field and answer your research questions**. For this tutorial, we strongly recommend that you reflect on what you have learned in the Statistics GSS course during Period 3. The Statistics GSS course taught you many useful tools for data analysis. Now it's time to put them into practice on a real ecological data set. For this tutorial, you will be using the same POEM data as in the tutorial on data wrangling. If you don't remember what these data are, please refer to the first sections of the first tutorial on data wrangling.</span>
<span id="cb40-16"><a href="#cb40-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-17"><a href="#cb40-17" aria-hidden="true" tabindex="-1"></a>Let's get started!</span>
<span id="cb40-18"><a href="#cb40-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-19"><a href="#cb40-19" aria-hidden="true" tabindex="-1"></a><span class="fu">## Importing POEM data</span></span>
<span id="cb40-20"><a href="#cb40-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-21"><a href="#cb40-21" aria-hidden="true" tabindex="-1"></a>The first thing to do after opening RStudio is to import the POEM data. This is exactly the same as what we already did in the first tutorial. <span class="co">[</span><span class="ot">Try writing the code yourself this time</span><span class="co">]</span>{.underline} (i.e. without looking too quickly at the solution)!</span>
<span id="cb40-22"><a href="#cb40-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-23"><a href="#cb40-23" aria-hidden="true" tabindex="-1"></a><span class="fu">### Download the POEM data from Zenodo</span></span>
<span id="cb40-24"><a href="#cb40-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-25"><a href="#cb40-25" aria-hidden="true" tabindex="-1"></a>The POEM data that will be used in this tutorial are available on a <span class="co">[</span><span class="ot">Zenodo repository</span><span class="co">](https://zenodo.org/records/10119982)</span>. You can download the data manually, but you can also do it using an R function called <span class="in">`download_zenodo()`</span>. Let's give it a try.</span>
<span id="cb40-26"><a href="#cb40-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-27"><a href="#cb40-27" aria-hidden="true" tabindex="-1"></a>First, install the *inborutils* R package using the following code:</span>
<span id="cb40-28"><a href="#cb40-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-31"><a href="#cb40-31" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb40-32"><a href="#cb40-32" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false </span></span>
<span id="cb40-33"><a href="#cb40-33" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true </span></span>
<span id="cb40-34"><a href="#cb40-34" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false </span></span>
<span id="cb40-35"><a href="#cb40-35" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false </span></span>
<span id="cb40-36"><a href="#cb40-36" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: false  </span></span>
<span id="cb40-37"><a href="#cb40-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-38"><a href="#cb40-38" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"inborutils"</span>, </span>
<span id="cb40-39"><a href="#cb40-39" aria-hidden="true" tabindex="-1"></a>                 <span class="at">repos =</span> <span class="fu">c</span>(<span class="at">inbo =</span> <span class="st">"https://inbo.r-universe.dev"</span>,</span>
<span id="cb40-40"><a href="#cb40-40" aria-hidden="true" tabindex="-1"></a>                           <span class="at">CRAN =</span> <span class="st">"https://cloud.r-project.org"</span>))</span>
<span id="cb40-41"><a href="#cb40-41" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb40-42"><a href="#cb40-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-43"><a href="#cb40-43" aria-hidden="true" tabindex="-1"></a>You can now download the data used in this tutorial using <span class="in">`download_zenodo()`</span>.</span>
<span id="cb40-44"><a href="#cb40-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-47"><a href="#cb40-47" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb40-48"><a href="#cb40-48" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true </span></span>
<span id="cb40-49"><a href="#cb40-49" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true </span></span>
<span id="cb40-50"><a href="#cb40-50" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false </span></span>
<span id="cb40-51"><a href="#cb40-51" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false  </span></span>
<span id="cb40-52"><a href="#cb40-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-53"><a href="#cb40-53" aria-hidden="true" tabindex="-1"></a>inborutils<span class="sc">::</span><span class="fu">download_zenodo</span>(<span class="at">doi=</span><span class="st">"10.5281/zenodo.10119982"</span>,</span>
<span id="cb40-54"><a href="#cb40-54" aria-hidden="true" tabindex="-1"></a>                            <span class="at">quiet=</span><span class="cn">TRUE</span>)</span>
<span id="cb40-55"><a href="#cb40-55" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb40-56"><a href="#cb40-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-57"><a href="#cb40-57" aria-hidden="true" tabindex="-1"></a>By default, the data will be downloaded as a zip file and will be stored in your working directory. If you do not know what is your working directory, run <span class="in">`getwd()`</span> in your R console. Let's extract (or unzip) the files we have just downloaded from Zenodo and let's store these files in a new folder called "Data_POEM":</span>
<span id="cb40-58"><a href="#cb40-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-61"><a href="#cb40-61" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb40-62"><a href="#cb40-62" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true </span></span>
<span id="cb40-63"><a href="#cb40-63" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true </span></span>
<span id="cb40-64"><a href="#cb40-64" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false </span></span>
<span id="cb40-65"><a href="#cb40-65" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false  </span></span>
<span id="cb40-66"><a href="#cb40-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-67"><a href="#cb40-67" aria-hidden="true" tabindex="-1"></a><span class="fu">unzip</span>(<span class="at">zipfile =</span> <span class="st">"Data_POEM_Paper1_Alonso-Crespo_et_al_2024-v1.0.zip"</span>,       </span>
<span id="cb40-68"><a href="#cb40-68" aria-hidden="true" tabindex="-1"></a>      <span class="at">exdir =</span> <span class="st">"Data_POEM"</span>)</span>
<span id="cb40-69"><a href="#cb40-69" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb40-70"><a href="#cb40-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-71"><a href="#cb40-71" aria-hidden="true" tabindex="-1"></a><span class="fu">### Load R packages</span></span>
<span id="cb40-72"><a href="#cb40-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-73"><a href="#cb40-73" aria-hidden="true" tabindex="-1"></a>Most of the functions we need for the rest of this tutorial are available with base R and in R packages from the *tidyverse* collection. We will also need the `read_excel()` function from the *readxl* package and the `kable()` function from the *knitr* package. We will also need functions from the *vegan*, *car*, *emmeans,* and *viridis* R packages later in this tutorial. If they are not yet installed in your library, install it using <span class="in">`install.packages()`</span>.</span>
<span id="cb40-74"><a href="#cb40-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-75"><a href="#cb40-75" aria-hidden="true" tabindex="-1"></a>You can load all the packages required for this tutorial using <span class="in">`library()`</span>.</span>
<span id="cb40-76"><a href="#cb40-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-79"><a href="#cb40-79" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb40-80"><a href="#cb40-80" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true </span></span>
<span id="cb40-81"><a href="#cb40-81" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true </span></span>
<span id="cb40-82"><a href="#cb40-82" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false </span></span>
<span id="cb40-83"><a href="#cb40-83" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false  </span></span>
<span id="cb40-84"><a href="#cb40-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-85"><a href="#cb40-85" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse) </span>
<span id="cb40-86"><a href="#cb40-86" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl) </span>
<span id="cb40-87"><a href="#cb40-87" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb40-88"><a href="#cb40-88" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(vegan)</span>
<span id="cb40-89"><a href="#cb40-89" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car)</span>
<span id="cb40-90"><a href="#cb40-90" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(emmeans)</span>
<span id="cb40-91"><a href="#cb40-91" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(viridis)</span>
<span id="cb40-92"><a href="#cb40-92" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb40-93"><a href="#cb40-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-94"><a href="#cb40-94" aria-hidden="true" tabindex="-1"></a><span class="fu">### Import data into R</span></span>
<span id="cb40-95"><a href="#cb40-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-96"><a href="#cb40-96" aria-hidden="true" tabindex="-1"></a>In the POEM project, raw biomass data (measured at the species level) are stored in different folders for the experiment started in 2020 (POEM2020) and the experiment started in 2021 (POEM2021). For each experiment, there is one data file for each growing season. As the data is stored in Excel files (.xlsx), we can use <span class="in">`read_excel()`</span> to import our data into R. For now, we will simply store each set of data in separate R objects.</span>
<span id="cb40-97"><a href="#cb40-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-100"><a href="#cb40-100" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb40-101"><a href="#cb40-101" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true </span></span>
<span id="cb40-102"><a href="#cb40-102" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true </span></span>
<span id="cb40-103"><a href="#cb40-103" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false </span></span>
<span id="cb40-104"><a href="#cb40-104" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false  </span></span>
<span id="cb40-105"><a href="#cb40-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-106"><a href="#cb40-106" aria-hidden="true" tabindex="-1"></a><span class="co">#Import data from the first experiment (POEM2020)  </span></span>
<span id="cb40-107"><a href="#cb40-107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-108"><a href="#cb40-108" aria-hidden="true" tabindex="-1"></a>poem2020_year1 <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"Data_POEM/POEMexperiment-Data_POEM_Paper1_Alonso-Crespo_et_al_2024-0c2abb7/Data/POEM2020/Data_Biomass_POEM2020_2020-07.xlsx"</span>)</span>
<span id="cb40-109"><a href="#cb40-109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-110"><a href="#cb40-110" aria-hidden="true" tabindex="-1"></a>poem2020_year2 <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"Data_POEM/POEMexperiment-Data_POEM_Paper1_Alonso-Crespo_et_al_2024-0c2abb7/Data/POEM2020/Data_Biomass_POEM2020_2021-06.xlsx"</span>)</span>
<span id="cb40-111"><a href="#cb40-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-112"><a href="#cb40-112" aria-hidden="true" tabindex="-1"></a>poem2020_year3 <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"Data_POEM/POEMexperiment-Data_POEM_Paper1_Alonso-Crespo_et_al_2024-0c2abb7/Data/POEM2020/Data_Biomass_POEM2020_2022-06.xlsx"</span>)  </span>
<span id="cb40-113"><a href="#cb40-113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-114"><a href="#cb40-114" aria-hidden="true" tabindex="-1"></a><span class="co">#Import data from the second experiment (POEM2021)  </span></span>
<span id="cb40-115"><a href="#cb40-115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-116"><a href="#cb40-116" aria-hidden="true" tabindex="-1"></a>poem2021_year1 <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"Data_POEM/POEMexperiment-Data_POEM_Paper1_Alonso-Crespo_et_al_2024-0c2abb7/Data/POEM2021/Data_Biomass_POEM2021_2021-07.xlsx"</span>)  </span>
<span id="cb40-117"><a href="#cb40-117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-118"><a href="#cb40-118" aria-hidden="true" tabindex="-1"></a>poem2021_year2 <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"Data_POEM/POEMexperiment-Data_POEM_Paper1_Alonso-Crespo_et_al_2024-0c2abb7/Data/POEM2021/Data_Biomass_POEM2021_2022-06.xlsx"</span>)  </span>
<span id="cb40-119"><a href="#cb40-119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-120"><a href="#cb40-120" aria-hidden="true" tabindex="-1"></a>poem2021_year3 <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"Data_POEM/POEMexperiment-Data_POEM_Paper1_Alonso-Crespo_et_al_2024-0c2abb7/Data/POEM2021/Data_Biomass_POEM2021_2023-06.xlsx"</span>)</span>
<span id="cb40-121"><a href="#cb40-121" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb40-122"><a href="#cb40-122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-123"><a href="#cb40-123" aria-hidden="true" tabindex="-1"></a>In RStudio, you can see how each data frame looks like using <span class="in">`View()`</span>.</span>
<span id="cb40-124"><a href="#cb40-124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-127"><a href="#cb40-127" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb40-128"><a href="#cb40-128" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false </span></span>
<span id="cb40-129"><a href="#cb40-129" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true </span></span>
<span id="cb40-130"><a href="#cb40-130" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false </span></span>
<span id="cb40-131"><a href="#cb40-131" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false  </span></span>
<span id="cb40-132"><a href="#cb40-132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-133"><a href="#cb40-133" aria-hidden="true" tabindex="-1"></a><span class="fu">View</span>(poem2021_year1)</span>
<span id="cb40-134"><a href="#cb40-134" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb40-135"><a href="#cb40-135" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-136"><a href="#cb40-136" aria-hidden="true" tabindex="-1"></a>You can see that each dataset consists of a number of observations (rows) of 6 variables (columns). These variables are:</span>
<span id="cb40-137"><a href="#cb40-137" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-138"><a href="#cb40-138" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Year**: the year of initiation of each experiment</span>
<span id="cb40-139"><a href="#cb40-139" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Harvest**: the date at which biomass data were collected (YYYY-MM)</span>
<span id="cb40-140"><a href="#cb40-140" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Plot**: the plot identification number (plot number - arrival order/replicate)</span>
<span id="cb40-141"><a href="#cb40-141" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Quadrat**: the quadrat identification number (plant biomass was collected in 2 or 4 quadrats per plot)</span>
<span id="cb40-142"><a href="#cb40-142" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Species**: the plant species name</span>
<span id="cb40-143"><a href="#cb40-143" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**SDW_g**: the shoot dry weight in grams</span>
<span id="cb40-144"><a href="#cb40-144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-145"><a href="#cb40-145" aria-hidden="true" tabindex="-1"></a>To enable data exploration and analysis, we now need to combine these different datasets, so that all the data is stored in the same R object. You can do this using <span class="in">`rbind()`</span>.</span>
<span id="cb40-146"><a href="#cb40-146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-149"><a href="#cb40-149" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb40-150"><a href="#cb40-150" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true </span></span>
<span id="cb40-151"><a href="#cb40-151" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true </span></span>
<span id="cb40-152"><a href="#cb40-152" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false </span></span>
<span id="cb40-153"><a href="#cb40-153" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false  </span></span>
<span id="cb40-154"><a href="#cb40-154" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-155"><a href="#cb40-155" aria-hidden="true" tabindex="-1"></a>poem_data <span class="ot">&lt;-</span> <span class="fu">rbind</span>(poem2020_year1,</span>
<span id="cb40-156"><a href="#cb40-156" aria-hidden="true" tabindex="-1"></a>                   poem2020_year2,</span>
<span id="cb40-157"><a href="#cb40-157" aria-hidden="true" tabindex="-1"></a>                   poem2020_year3,</span>
<span id="cb40-158"><a href="#cb40-158" aria-hidden="true" tabindex="-1"></a>                   poem2021_year1,</span>
<span id="cb40-159"><a href="#cb40-159" aria-hidden="true" tabindex="-1"></a>                   poem2021_year2,</span>
<span id="cb40-160"><a href="#cb40-160" aria-hidden="true" tabindex="-1"></a>                   poem2021_year3)</span>
<span id="cb40-161"><a href="#cb40-161" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb40-162"><a href="#cb40-162" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-163"><a href="#cb40-163" aria-hidden="true" tabindex="-1"></a><span class="fu">## Organise POEM data</span></span>
<span id="cb40-164"><a href="#cb40-164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-165"><a href="#cb40-165" aria-hidden="true" tabindex="-1"></a>Write R code to reorganise the data so that we can analyse them. Make sure to do the following:</span>
<span id="cb40-166"><a href="#cb40-166" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-167"><a href="#cb40-167" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Create new columns based on the information contained in the Plot column. This can be done easily using <span class="in">`separate_wider_delim()`</span> and <span class="in">`separate_wider_position()`</span>. Make sure to add the following three columns to the dataset:</span>
<span id="cb40-168"><a href="#cb40-168" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-169"><a href="#cb40-169" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>PlotID (the plot number)</span>
<span id="cb40-170"><a href="#cb40-170" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Arrival (the order of arrival treatment: S, F, G, L, B)</span>
<span id="cb40-171"><a href="#cb40-171" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Replicate (the replicate number)</span>
<span id="cb40-172"><a href="#cb40-172" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-173"><a href="#cb40-173" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Make sure that PlotID and Replicate are stored as numerical variables. You can do this by combining <span class="in">`mutate()`</span> with <span class="in">`as.numeric()`</span>.</span>
<span id="cb40-174"><a href="#cb40-174" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-175"><a href="#cb40-175" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Finally, rename the column storing plant biomass values (SDW_g). Name it "Biomass". You can do this using <span class="in">`rename()`</span>.</span>
<span id="cb40-176"><a href="#cb40-176" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-179"><a href="#cb40-179" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb40-180"><a href="#cb40-180" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb40-181"><a href="#cb40-181" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb40-182"><a href="#cb40-182" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb40-183"><a href="#cb40-183" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb40-184"><a href="#cb40-184" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-185"><a href="#cb40-185" aria-hidden="true" tabindex="-1"></a>poem_data <span class="ot">&lt;-</span> poem_data <span class="sc">|&gt;</span> </span>
<span id="cb40-186"><a href="#cb40-186" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate_wider_delim</span>(<span class="at">cols =</span> Plot,</span>
<span id="cb40-187"><a href="#cb40-187" aria-hidden="true" tabindex="-1"></a>                       <span class="at">delim=</span><span class="st">"-"</span>,</span>
<span id="cb40-188"><a href="#cb40-188" aria-hidden="true" tabindex="-1"></a>                       <span class="at">names=</span><span class="fu">c</span>(<span class="st">"PlotID"</span>, <span class="st">"Treatment"</span>),</span>
<span id="cb40-189"><a href="#cb40-189" aria-hidden="true" tabindex="-1"></a>                       <span class="at">cols_remove=</span><span class="cn">TRUE</span>) <span class="sc">|&gt;</span> </span>
<span id="cb40-190"><a href="#cb40-190" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate_wider_position</span>(<span class="at">cols =</span> Treatment,</span>
<span id="cb40-191"><a href="#cb40-191" aria-hidden="true" tabindex="-1"></a>                          <span class="at">width=</span><span class="fu">c</span>(<span class="at">Arrival=</span><span class="dv">1</span>, <span class="at">Replicate=</span><span class="dv">1</span>),</span>
<span id="cb40-192"><a href="#cb40-192" aria-hidden="true" tabindex="-1"></a>                          <span class="at">cols_remove=</span><span class="cn">TRUE</span>) <span class="sc">|&gt;</span> </span>
<span id="cb40-193"><a href="#cb40-193" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">PlotID=</span><span class="fu">as.numeric</span>(PlotID),</span>
<span id="cb40-194"><a href="#cb40-194" aria-hidden="true" tabindex="-1"></a>         <span class="at">Replicate=</span><span class="fu">as.numeric</span>(Replicate)) <span class="sc">|&gt;</span> </span>
<span id="cb40-195"><a href="#cb40-195" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">Biomass=</span>SDW_g)</span>
<span id="cb40-196"><a href="#cb40-196" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb40-197"><a href="#cb40-197" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-198"><a href="#cb40-198" aria-hidden="true" tabindex="-1"></a>Let's take a quick look at the first ten rows of our dataset using <span class="in">`head().`</span> We can also use <span class="in">`kable()`</span> in the *knitr* package to produce a nice looking table in your R console.</span>
<span id="cb40-199"><a href="#cb40-199" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-202"><a href="#cb40-202" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb40-203"><a href="#cb40-203" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true </span></span>
<span id="cb40-204"><a href="#cb40-204" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true </span></span>
<span id="cb40-205"><a href="#cb40-205" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false </span></span>
<span id="cb40-206"><a href="#cb40-206" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false  </span></span>
<span id="cb40-207"><a href="#cb40-207" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-208"><a href="#cb40-208" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(<span class="fu">head</span>(poem_data, <span class="at">n =</span> <span class="dv">10</span>))</span>
<span id="cb40-209"><a href="#cb40-209" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb40-210"><a href="#cb40-210" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-211"><a href="#cb40-211" aria-hidden="true" tabindex="-1"></a><span class="fu">## Exercise 1: Do plant order of arrival and year of initiation of an experiment affect the total aboveground biomass production of plant communities?</span></span>
<span id="cb40-212"><a href="#cb40-212" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-213"><a href="#cb40-213" aria-hidden="true" tabindex="-1"></a><span class="fu">### Step 1: Calculate the total biomass production in each plot</span></span>
<span id="cb40-214"><a href="#cb40-214" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-215"><a href="#cb40-215" aria-hidden="true" tabindex="-1"></a>Before starting analysing our data, we must first calculate the total biomass production of each plant community at each harvest date. This can be done by summing the biomass value of all species collected in a plot at a given harvest date. Use what you learned in the data wrangling tutorial to write a piece of R code that does that. When writing your code, remember the following:</span>
<span id="cb40-216"><a href="#cb40-216" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-217"><a href="#cb40-217" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Store the dataset in a new object called <span class="in">`poem_data_biomass`</span>.</span>
<span id="cb40-218"><a href="#cb40-218" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-219"><a href="#cb40-219" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Do not forget to standardise biomass data in g/m². Each quadrat has a surface area of 0.1 m². Use <span class="in">`mutate()`</span> to add a new column called "Std_biomass" to the dataset.</span>
<span id="cb40-220"><a href="#cb40-220" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-221"><a href="#cb40-221" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Depending on the harvest date, all plant species located within 2 or 4 randomly positioned quadrats were collected in each plot. To obtain a biomass value per species and per plot, it is first necessary to calculate the average biomass value for each species in a plot at each harvest date (i.e., across quadrats). Use <span class="in">`group_by()`</span> and <span class="in">`summarise()`</span> to do that.</span>
<span id="cb40-222"><a href="#cb40-222" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-223"><a href="#cb40-223" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Once you have calculated the average biomass value for each species in a plot, use <span class="in">`group_by()`</span> and <span class="in">`summarise()`</span> again to calculate the total aboveground biomass in each plot by adding up the yield (in g/m²) of all species in a plot.</span>
<span id="cb40-224"><a href="#cb40-224" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-225"><a href="#cb40-225" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Only keep the data for the second harvest date of each sub-experiment (2021-06 for the experiment initiated in 2020, 2022-06 for the experiment initiated in 2021).</span>
<span id="cb40-226"><a href="#cb40-226" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-229"><a href="#cb40-229" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb40-230"><a href="#cb40-230" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true </span></span>
<span id="cb40-231"><a href="#cb40-231" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true </span></span>
<span id="cb40-232"><a href="#cb40-232" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false </span></span>
<span id="cb40-233"><a href="#cb40-233" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb40-234"><a href="#cb40-234" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-235"><a href="#cb40-235" aria-hidden="true" tabindex="-1"></a>poem_data_biomass <span class="ot">&lt;-</span> poem_data <span class="sc">|&gt;</span> </span>
<span id="cb40-236"><a href="#cb40-236" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Std_biomass=</span>Biomass<span class="sc">/</span><span class="fl">0.1</span>, <span class="co">#Convert to g/m²</span></span>
<span id="cb40-237"><a href="#cb40-237" aria-hidden="true" tabindex="-1"></a>         <span class="at">.after =</span> <span class="st">"Biomass"</span>) <span class="sc">|&gt;</span>  <span class="co">#Specify that we want this new column to be after the Biomass column</span></span>
<span id="cb40-238"><a href="#cb40-238" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Year, Harvest, PlotID, Arrival, Species) <span class="sc">|&gt;</span> <span class="co">#Define grouping factors in your data</span></span>
<span id="cb40-239"><a href="#cb40-239" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Std_biomass=</span><span class="fu">mean</span>(Std_biomass)) <span class="sc">|&gt;</span> <span class="co">#Calculates the average productivity of each species in a plot</span></span>
<span id="cb40-240"><a href="#cb40-240" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Year, Harvest, PlotID, Arrival) <span class="sc">|&gt;</span> <span class="co">#Redefine groups (interested in summing biomass values across species)</span></span>
<span id="cb40-241"><a href="#cb40-241" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Total_biomass=</span><span class="fu">sum</span>(Std_biomass)) <span class="sc">|&gt;</span>  <span class="co">#Calculate total biomass production in each plot</span></span>
<span id="cb40-242"><a href="#cb40-242" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>((Year <span class="sc">==</span> <span class="dv">2020</span> <span class="sc">&amp;</span> Harvest <span class="sc">==</span> <span class="st">"2021-06"</span>)<span class="sc">|</span>(Year <span class="sc">==</span> <span class="dv">2021</span> <span class="sc">&amp;</span> Harvest <span class="sc">==</span> <span class="st">"2022-06"</span>))</span>
<span id="cb40-243"><a href="#cb40-243" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb40-244"><a href="#cb40-244" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-245"><a href="#cb40-245" aria-hidden="true" tabindex="-1"></a>Let's take a quick look at the first ten rows of our new dataset using <span class="in">`head().`</span></span>
<span id="cb40-246"><a href="#cb40-246" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-249"><a href="#cb40-249" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb40-250"><a href="#cb40-250" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true </span></span>
<span id="cb40-251"><a href="#cb40-251" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true </span></span>
<span id="cb40-252"><a href="#cb40-252" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false </span></span>
<span id="cb40-253"><a href="#cb40-253" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false  </span></span>
<span id="cb40-254"><a href="#cb40-254" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-255"><a href="#cb40-255" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(<span class="fu">head</span>(poem_data_biomass, <span class="at">n =</span> <span class="dv">10</span>))</span>
<span id="cb40-256"><a href="#cb40-256" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb40-257"><a href="#cb40-257" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-258"><a href="#cb40-258" aria-hidden="true" tabindex="-1"></a><span class="fu">### Step 2: Visualise raw data</span></span>
<span id="cb40-259"><a href="#cb40-259" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-260"><a href="#cb40-260" aria-hidden="true" tabindex="-1"></a>Before fitting a statistical model to our data, let's first create a plot to help us answer our research question: Do plant order of arrival and year of initiation of an experiment affect the total aboveground biomass production of plant communities?</span>
<span id="cb40-261"><a href="#cb40-261" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-262"><a href="#cb40-262" aria-hidden="true" tabindex="-1"></a>This research question gives us important information about what needs to be represented. The first half of the question tells us that our graph should present results for all possible combinations of plant arrival order (S, F, G, L, B) and year of initiation (2020 and 2021). These are the fixed factors of the experiment. We can make sure that these columns are correctly interpreted as factors by using <span class="in">`factor()`</span>. It may also be a good idea to reorder factor levels in a meaningful way (S, F, G, L, B). The second half of the research question tells us that we need to show the differences in total aboveground biomass production between all possible treatment combinations. This is the response variable of our experiment.</span>
<span id="cb40-263"><a href="#cb40-263" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-264"><a href="#cb40-264" aria-hidden="true" tabindex="-1"></a>Using what you have learned in the previous tutorials, create a high-quality figure that answers the research question. Feel free to personalise your plot in any way you think best communicates the results (you do not necessarily have to produce the same plot as below). What can you already notice from this graph? Does it look like ANOVA (ANalysis Of VAriance)) assumptions are met?</span>
<span id="cb40-265"><a href="#cb40-265" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-266"><a href="#cb40-266" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb40-267"><a href="#cb40-267" aria-hidden="true" tabindex="-1"></a><span class="fu">## Solution (code)</span></span>
<span id="cb40-268"><a href="#cb40-268" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-271"><a href="#cb40-271" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb40-272"><a href="#cb40-272" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true </span></span>
<span id="cb40-273"><a href="#cb40-273" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true </span></span>
<span id="cb40-274"><a href="#cb40-274" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false </span></span>
<span id="cb40-275"><a href="#cb40-275" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb40-276"><a href="#cb40-276" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb40-277"><a href="#cb40-277" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-278"><a href="#cb40-278" aria-hidden="true" tabindex="-1"></a>poem_data_biomass<span class="sc">$</span>Year <span class="ot">&lt;-</span> <span class="fu">factor</span>(poem_data_biomass<span class="sc">$</span>Year)</span>
<span id="cb40-279"><a href="#cb40-279" aria-hidden="true" tabindex="-1"></a>poem_data_biomass<span class="sc">$</span>Arrival <span class="ot">&lt;-</span> <span class="fu">factor</span>(poem_data_biomass<span class="sc">$</span>Arrival,</span>
<span id="cb40-280"><a href="#cb40-280" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">levels=</span><span class="fu">c</span>(<span class="st">"S"</span>, <span class="st">"F"</span>, <span class="st">"G"</span>, <span class="st">"L"</span>, <span class="st">"B"</span>))</span>
<span id="cb40-281"><a href="#cb40-281" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-282"><a href="#cb40-282" aria-hidden="true" tabindex="-1"></a>plot <span class="ot">&lt;-</span> poem_data_biomass <span class="sc">|&gt;</span> </span>
<span id="cb40-283"><a href="#cb40-283" aria-hidden="true" tabindex="-1"></a>          <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>Arrival,</span>
<span id="cb40-284"><a href="#cb40-284" aria-hidden="true" tabindex="-1"></a>                     <span class="at">y=</span>Total_biomass))<span class="sc">+</span></span>
<span id="cb40-285"><a href="#cb40-285" aria-hidden="true" tabindex="-1"></a>          <span class="fu">facet_grid</span>(<span class="sc">~</span>Year)<span class="sc">+</span></span>
<span id="cb40-286"><a href="#cb40-286" aria-hidden="true" tabindex="-1"></a>          <span class="fu">geom_jitter</span>(<span class="at">height =</span> <span class="dv">0</span>,</span>
<span id="cb40-287"><a href="#cb40-287" aria-hidden="true" tabindex="-1"></a>                      <span class="at">width=</span><span class="fl">0.1</span>,</span>
<span id="cb40-288"><a href="#cb40-288" aria-hidden="true" tabindex="-1"></a>                      <span class="at">shape=</span><span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb40-289"><a href="#cb40-289" aria-hidden="true" tabindex="-1"></a>          <span class="fu">stat_summary</span>(<span class="at">fun.data =</span> <span class="st">"mean_cl_boot"</span>)<span class="sc">+</span></span>
<span id="cb40-290"><a href="#cb40-290" aria-hidden="true" tabindex="-1"></a>          <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb40-291"><a href="#cb40-291" aria-hidden="true" tabindex="-1"></a>          <span class="fu">xlab</span>(<span class="st">"Plant order of arrival"</span>)<span class="sc">+</span></span>
<span id="cb40-292"><a href="#cb40-292" aria-hidden="true" tabindex="-1"></a>          <span class="fu">ylab</span>(<span class="st">"Total shoot dry weight (g/m²)"</span>)<span class="sc">+</span></span>
<span id="cb40-293"><a href="#cb40-293" aria-hidden="true" tabindex="-1"></a>          <span class="fu">theme</span>(<span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t=</span><span class="dv">10</span>)),</span>
<span id="cb40-294"><a href="#cb40-294" aria-hidden="true" tabindex="-1"></a>                <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">r=</span><span class="dv">10</span>)),</span>
<span id="cb40-295"><a href="#cb40-295" aria-hidden="true" tabindex="-1"></a>                <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">colour=</span><span class="st">"black"</span>))<span class="sc">+</span></span>
<span id="cb40-296"><a href="#cb40-296" aria-hidden="true" tabindex="-1"></a>          <span class="fu">scale_y_continuous</span>(<span class="at">breaks=</span><span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">100</span>,</span>
<span id="cb40-297"><a href="#cb40-297" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">to =</span> <span class="dv">600</span>,</span>
<span id="cb40-298"><a href="#cb40-298" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">by =</span> <span class="dv">100</span>))</span>
<span id="cb40-299"><a href="#cb40-299" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb40-300"><a href="#cb40-300" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-301"><a href="#cb40-301" aria-hidden="true" tabindex="-1"></a><span class="fu">## Solution (plot)</span></span>
<span id="cb40-302"><a href="#cb40-302" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-305"><a href="#cb40-305" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb40-306"><a href="#cb40-306" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true </span></span>
<span id="cb40-307"><a href="#cb40-307" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true </span></span>
<span id="cb40-308"><a href="#cb40-308" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false </span></span>
<span id="cb40-309"><a href="#cb40-309" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb40-310"><a href="#cb40-310" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb40-311"><a href="#cb40-311" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-312"><a href="#cb40-312" aria-hidden="true" tabindex="-1"></a>plot</span>
<span id="cb40-313"><a href="#cb40-313" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb40-314"><a href="#cb40-314" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb40-315"><a href="#cb40-315" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-316"><a href="#cb40-316" aria-hidden="true" tabindex="-1"></a><span class="fu">### Step 3: Fit a model</span></span>
<span id="cb40-317"><a href="#cb40-317" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-318"><a href="#cb40-318" aria-hidden="true" tabindex="-1"></a>Let's fit a statistical model to study the relationship between our response variable of interest (Total_biomass) and our two experimental factors (Year and Arrival). There are different ways to do this in R. First, let's check whether a ***simple linear regression model*** can correctly model our data. We will use the <span class="in">`lm()`</span> function to fit this linear model (this will give us the same results as the <span class="in">`aov()`</span> function). Note that each group being compared has 5 independent observations, which is not sufficient to test the assumption that the data are normally distributed at each combination of factor levels.</span>
<span id="cb40-319"><a href="#cb40-319" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-320"><a href="#cb40-320" aria-hidden="true" tabindex="-1"></a>The syntax to fit a simple linear regression model with two predictor variables in R is as follows:</span>
<span id="cb40-321"><a href="#cb40-321" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-322"><a href="#cb40-322" aria-hidden="true" tabindex="-1"></a><span class="in">`model &lt;- lm(Response ~ Predictor1*Predictor2, data)`</span></span>
<span id="cb40-323"><a href="#cb40-323" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-324"><a href="#cb40-324" aria-hidden="true" tabindex="-1"></a>The asterisks (<span class="sc">\*</span>) means that we want to take the interaction between predictor variables into account (you then assume that Predictor1 and Predictor2 have non-additive effects on your response variable). Using a plus sign (+) instead of an asterisks would fit a model without considering an interaction between predictors (in that case, you then assume that Predictor1 and Predictor2 have additive effects on your response variable).</span>
<span id="cb40-325"><a href="#cb40-325" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-328"><a href="#cb40-328" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb40-329"><a href="#cb40-329" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true </span></span>
<span id="cb40-330"><a href="#cb40-330" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true </span></span>
<span id="cb40-331"><a href="#cb40-331" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false </span></span>
<span id="cb40-332"><a href="#cb40-332" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false </span></span>
<span id="cb40-333"><a href="#cb40-333" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-334"><a href="#cb40-334" aria-hidden="true" tabindex="-1"></a><span class="co">#Fit simple linear regression model</span></span>
<span id="cb40-335"><a href="#cb40-335" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-336"><a href="#cb40-336" aria-hidden="true" tabindex="-1"></a>model1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(Total_biomass <span class="sc">~</span> Year<span class="sc">*</span>Arrival,</span>
<span id="cb40-337"><a href="#cb40-337" aria-hidden="true" tabindex="-1"></a>             <span class="at">data =</span> poem_data_biomass)</span>
<span id="cb40-338"><a href="#cb40-338" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb40-339"><a href="#cb40-339" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-340"><a href="#cb40-340" aria-hidden="true" tabindex="-1"></a>Before checking model results, let's first make sure that model assumptions are met. We can check for homoscedasticity by plotting model residuals (i.e., the difference between model predictions and observations) against fitted values (i.e., model predictions). This is called a residual plot. Fitted values can be calculated using <span class="in">`predict()`</span>. Residuals can be calculated using <span class="in">`residuals()`</span>. Try to create such a plot using what you have learned in previous tutorials. Do you notice any pattern in this residual plot?</span>
<span id="cb40-341"><a href="#cb40-341" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-342"><a href="#cb40-342" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb40-343"><a href="#cb40-343" aria-hidden="true" tabindex="-1"></a><span class="fu">## Solution (code)</span></span>
<span id="cb40-344"><a href="#cb40-344" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-347"><a href="#cb40-347" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb40-348"><a href="#cb40-348" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true </span></span>
<span id="cb40-349"><a href="#cb40-349" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true </span></span>
<span id="cb40-350"><a href="#cb40-350" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false </span></span>
<span id="cb40-351"><a href="#cb40-351" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb40-352"><a href="#cb40-352" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb40-353"><a href="#cb40-353" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-354"><a href="#cb40-354" aria-hidden="true" tabindex="-1"></a>plot <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">predicted =</span> <span class="fu">predict</span>(model1),</span>
<span id="cb40-355"><a href="#cb40-355" aria-hidden="true" tabindex="-1"></a>           <span class="at">residuals =</span> <span class="fu">residuals</span>(model1)) <span class="sc">|&gt;</span> </span>
<span id="cb40-356"><a href="#cb40-356" aria-hidden="true" tabindex="-1"></a>        <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>predicted,</span>
<span id="cb40-357"><a href="#cb40-357" aria-hidden="true" tabindex="-1"></a>                 <span class="at">y=</span>residuals))<span class="sc">+</span></span>
<span id="cb40-358"><a href="#cb40-358" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb40-359"><a href="#cb40-359" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>,</span>
<span id="cb40-360"><a href="#cb40-360" aria-hidden="true" tabindex="-1"></a>                   <span class="at">colour =</span> <span class="st">"red"</span>,</span>
<span id="cb40-361"><a href="#cb40-361" aria-hidden="true" tabindex="-1"></a>                   <span class="at">linetype =</span> <span class="dv">2</span>)<span class="sc">+</span></span>
<span id="cb40-362"><a href="#cb40-362" aria-hidden="true" tabindex="-1"></a>        <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb40-363"><a href="#cb40-363" aria-hidden="true" tabindex="-1"></a>        <span class="fu">xlab</span>(<span class="st">"Predicted values"</span>)<span class="sc">+</span></span>
<span id="cb40-364"><a href="#cb40-364" aria-hidden="true" tabindex="-1"></a>        <span class="fu">ylab</span>(<span class="st">"Residuals"</span>)<span class="sc">+</span></span>
<span id="cb40-365"><a href="#cb40-365" aria-hidden="true" tabindex="-1"></a>        <span class="fu">theme</span>(<span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t=</span><span class="dv">10</span>)),</span>
<span id="cb40-366"><a href="#cb40-366" aria-hidden="true" tabindex="-1"></a>              <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">r=</span><span class="dv">10</span>)),</span>
<span id="cb40-367"><a href="#cb40-367" aria-hidden="true" tabindex="-1"></a>              <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">colour=</span><span class="st">"black"</span>))</span>
<span id="cb40-368"><a href="#cb40-368" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb40-369"><a href="#cb40-369" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-370"><a href="#cb40-370" aria-hidden="true" tabindex="-1"></a><span class="fu">## Solution (plot)</span></span>
<span id="cb40-371"><a href="#cb40-371" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-374"><a href="#cb40-374" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb40-375"><a href="#cb40-375" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true </span></span>
<span id="cb40-376"><a href="#cb40-376" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true </span></span>
<span id="cb40-377"><a href="#cb40-377" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false </span></span>
<span id="cb40-378"><a href="#cb40-378" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb40-379"><a href="#cb40-379" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb40-380"><a href="#cb40-380" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-381"><a href="#cb40-381" aria-hidden="true" tabindex="-1"></a>plot</span>
<span id="cb40-382"><a href="#cb40-382" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb40-383"><a href="#cb40-383" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb40-384"><a href="#cb40-384" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-385"><a href="#cb40-385" aria-hidden="true" tabindex="-1"></a>It seems that there is a strong mean - variance relationship in our data (heteroscedasticity), which means that the model we just fitted is not the best option. A better approach is to switch to a ***generalised linear model*** (also referred to as GLM). Generalised linear models can be fitted using the <span class="in">`glm()`</span> function in the *stats* package. The syntax is exactly the same as for the <span class="in">`lm()`</span> function, but there is an extra argument to specify: <span class="in">`family`</span>. The <span class="in">`family`</span> argument allows you to describe the error distribution and the link function to be used in the model.</span>
<span id="cb40-386"><a href="#cb40-386" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-387"><a href="#cb40-387" aria-hidden="true" tabindex="-1"></a>::: callout-note</span>
<span id="cb40-388"><a href="#cb40-388" aria-hidden="true" tabindex="-1"></a><span class="fu">## Relationship between `lm()` and `glm()`</span></span>
<span id="cb40-389"><a href="#cb40-389" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-390"><a href="#cb40-390" aria-hidden="true" tabindex="-1"></a>A simple linear regression model (<span class="in">`lm()`</span>) is a special case of a gaussian generalised linear model with an identity link. This means that</span>
<span id="cb40-391"><a href="#cb40-391" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-392"><a href="#cb40-392" aria-hidden="true" tabindex="-1"></a><span class="in">`lm(Response ~ Predictor1*Predictor2, data)`</span></span>
<span id="cb40-393"><a href="#cb40-393" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-394"><a href="#cb40-394" aria-hidden="true" tabindex="-1"></a>and</span>
<span id="cb40-395"><a href="#cb40-395" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-396"><a href="#cb40-396" aria-hidden="true" tabindex="-1"></a><span class="in">`glm(Response ~ Predictor1*Predictor2, data, family=gaussian(link="identity")`</span></span>
<span id="cb40-397"><a href="#cb40-397" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-398"><a href="#cb40-398" aria-hidden="true" tabindex="-1"></a>produce the same results.</span>
<span id="cb40-399"><a href="#cb40-399" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb40-400"><a href="#cb40-400" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-401"><a href="#cb40-401" aria-hidden="true" tabindex="-1"></a>Instead of using a gaussian distribution, a gamma distribution can be used for a response variable that is continuous and strictly positive. Negative values and zeros are not allowed with a gamma distribution. This distribution is useful to model variables such as biomass, length, etc. Using a log link function will also help deal with heteroscedasticity. This can be done by writing <span class="in">`family=Gamma(link="log")`</span> in <span class="in">`glm()`</span>.</span>
<span id="cb40-402"><a href="#cb40-402" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-403"><a href="#cb40-403" aria-hidden="true" tabindex="-1"></a>Let's fit a new model (this time a GLM) to our data.</span>
<span id="cb40-404"><a href="#cb40-404" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-407"><a href="#cb40-407" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb40-408"><a href="#cb40-408" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true </span></span>
<span id="cb40-409"><a href="#cb40-409" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true </span></span>
<span id="cb40-410"><a href="#cb40-410" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false </span></span>
<span id="cb40-411"><a href="#cb40-411" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false </span></span>
<span id="cb40-412"><a href="#cb40-412" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-413"><a href="#cb40-413" aria-hidden="true" tabindex="-1"></a><span class="co">#Fit simple linear regression model</span></span>
<span id="cb40-414"><a href="#cb40-414" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-415"><a href="#cb40-415" aria-hidden="true" tabindex="-1"></a>model2 <span class="ot">&lt;-</span> <span class="fu">glm</span>(Total_biomass <span class="sc">~</span> Year<span class="sc">*</span>Arrival,</span>
<span id="cb40-416"><a href="#cb40-416" aria-hidden="true" tabindex="-1"></a>              <span class="at">data =</span> poem_data_biomass,</span>
<span id="cb40-417"><a href="#cb40-417" aria-hidden="true" tabindex="-1"></a>              <span class="at">family =</span> <span class="fu">Gamma</span>(<span class="at">link=</span><span class="st">"log"</span>))</span>
<span id="cb40-418"><a href="#cb40-418" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb40-419"><a href="#cb40-419" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-420"><a href="#cb40-420" aria-hidden="true" tabindex="-1"></a>Before checking model results, let's first create a residual plot. What do you notice? What's new in this residual plot?</span>
<span id="cb40-421"><a href="#cb40-421" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-422"><a href="#cb40-422" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb40-423"><a href="#cb40-423" aria-hidden="true" tabindex="-1"></a><span class="fu">## Solution (code)</span></span>
<span id="cb40-424"><a href="#cb40-424" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-427"><a href="#cb40-427" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb40-428"><a href="#cb40-428" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true </span></span>
<span id="cb40-429"><a href="#cb40-429" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true </span></span>
<span id="cb40-430"><a href="#cb40-430" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false </span></span>
<span id="cb40-431"><a href="#cb40-431" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb40-432"><a href="#cb40-432" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb40-433"><a href="#cb40-433" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-434"><a href="#cb40-434" aria-hidden="true" tabindex="-1"></a>plot <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">predicted =</span> <span class="fu">predict</span>(model2),</span>
<span id="cb40-435"><a href="#cb40-435" aria-hidden="true" tabindex="-1"></a>           <span class="at">residuals =</span> <span class="fu">residuals</span>(model2)) <span class="sc">|&gt;</span> </span>
<span id="cb40-436"><a href="#cb40-436" aria-hidden="true" tabindex="-1"></a>        <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>predicted,</span>
<span id="cb40-437"><a href="#cb40-437" aria-hidden="true" tabindex="-1"></a>                 <span class="at">y=</span>residuals))<span class="sc">+</span></span>
<span id="cb40-438"><a href="#cb40-438" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb40-439"><a href="#cb40-439" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>,</span>
<span id="cb40-440"><a href="#cb40-440" aria-hidden="true" tabindex="-1"></a>                   <span class="at">colour =</span> <span class="st">"red"</span>,</span>
<span id="cb40-441"><a href="#cb40-441" aria-hidden="true" tabindex="-1"></a>                   <span class="at">linetype =</span> <span class="dv">2</span>)<span class="sc">+</span></span>
<span id="cb40-442"><a href="#cb40-442" aria-hidden="true" tabindex="-1"></a>        <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb40-443"><a href="#cb40-443" aria-hidden="true" tabindex="-1"></a>        <span class="fu">xlab</span>(<span class="st">"Predicted values"</span>)<span class="sc">+</span></span>
<span id="cb40-444"><a href="#cb40-444" aria-hidden="true" tabindex="-1"></a>        <span class="fu">ylab</span>(<span class="st">"Pearson residuals"</span>)<span class="sc">+</span></span>
<span id="cb40-445"><a href="#cb40-445" aria-hidden="true" tabindex="-1"></a>        <span class="fu">theme</span>(<span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t=</span><span class="dv">10</span>)),</span>
<span id="cb40-446"><a href="#cb40-446" aria-hidden="true" tabindex="-1"></a>              <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">r=</span><span class="dv">10</span>)),</span>
<span id="cb40-447"><a href="#cb40-447" aria-hidden="true" tabindex="-1"></a>              <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">colour=</span><span class="st">"black"</span>))</span>
<span id="cb40-448"><a href="#cb40-448" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb40-449"><a href="#cb40-449" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-450"><a href="#cb40-450" aria-hidden="true" tabindex="-1"></a><span class="fu">## Solution (plot)</span></span>
<span id="cb40-451"><a href="#cb40-451" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-454"><a href="#cb40-454" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb40-455"><a href="#cb40-455" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true </span></span>
<span id="cb40-456"><a href="#cb40-456" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true </span></span>
<span id="cb40-457"><a href="#cb40-457" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false </span></span>
<span id="cb40-458"><a href="#cb40-458" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb40-459"><a href="#cb40-459" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb40-460"><a href="#cb40-460" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-461"><a href="#cb40-461" aria-hidden="true" tabindex="-1"></a>plot</span>
<span id="cb40-462"><a href="#cb40-462" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb40-463"><a href="#cb40-463" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb40-464"><a href="#cb40-464" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-465"><a href="#cb40-465" aria-hidden="true" tabindex="-1"></a>Let's now take a look at model outputs. You can do this using <span class="in">`summary()`</span>. This output contains a wealth of useful information. The coefficient table gives you the coefficients of the model. When looking at the results of the statistical tests, it seems that only three to four coefficients in the equation above can be considered significantly different from zero (marked with a dot or an asterisks).</span>
<span id="cb40-466"><a href="#cb40-466" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-467"><a href="#cb40-467" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb40-468"><a href="#cb40-468" aria-hidden="true" tabindex="-1"></a><span class="fu">## Solution (code)</span></span>
<span id="cb40-469"><a href="#cb40-469" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-472"><a href="#cb40-472" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb40-473"><a href="#cb40-473" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true </span></span>
<span id="cb40-474"><a href="#cb40-474" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true </span></span>
<span id="cb40-475"><a href="#cb40-475" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false </span></span>
<span id="cb40-476"><a href="#cb40-476" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false </span></span>
<span id="cb40-477"><a href="#cb40-477" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-478"><a href="#cb40-478" aria-hidden="true" tabindex="-1"></a>output <span class="ot">&lt;-</span> <span class="fu">summary</span>(model2)</span>
<span id="cb40-479"><a href="#cb40-479" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb40-480"><a href="#cb40-480" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-481"><a href="#cb40-481" aria-hidden="true" tabindex="-1"></a><span class="fu">## Solution (output)</span></span>
<span id="cb40-482"><a href="#cb40-482" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-485"><a href="#cb40-485" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb40-486"><a href="#cb40-486" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true </span></span>
<span id="cb40-487"><a href="#cb40-487" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true </span></span>
<span id="cb40-488"><a href="#cb40-488" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false </span></span>
<span id="cb40-489"><a href="#cb40-489" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb40-490"><a href="#cb40-490" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-491"><a href="#cb40-491" aria-hidden="true" tabindex="-1"></a>output</span>
<span id="cb40-492"><a href="#cb40-492" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb40-493"><a href="#cb40-493" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb40-494"><a href="#cb40-494" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-495"><a href="#cb40-495" aria-hidden="true" tabindex="-1"></a>GLM models do not return any R² values (like for simple linear regression models). The closest we can get is to calculate the explained deviance:</span>
<span id="cb40-496"><a href="#cb40-496" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-497"><a href="#cb40-497" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb40-498"><a href="#cb40-498" aria-hidden="true" tabindex="-1"></a>ExplainedDeviance = 100 \times \frac{NullDeviance - ResidualDeviance}{NullDeviance}</span>
<span id="cb40-499"><a href="#cb40-499" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb40-500"><a href="#cb40-500" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-503"><a href="#cb40-503" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb40-504"><a href="#cb40-504" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true </span></span>
<span id="cb40-505"><a href="#cb40-505" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true </span></span>
<span id="cb40-506"><a href="#cb40-506" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false </span></span>
<span id="cb40-507"><a href="#cb40-507" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false </span></span>
<span id="cb40-508"><a href="#cb40-508" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-509"><a href="#cb40-509" aria-hidden="true" tabindex="-1"></a>null_deviance <span class="ot">&lt;-</span> <span class="fu">summary</span>(model2)<span class="sc">$</span>null.deviance</span>
<span id="cb40-510"><a href="#cb40-510" aria-hidden="true" tabindex="-1"></a>residual_deviance <span class="ot">&lt;-</span> <span class="fu">summary</span>(model2)<span class="sc">$</span>deviance</span>
<span id="cb40-511"><a href="#cb40-511" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-512"><a href="#cb40-512" aria-hidden="true" tabindex="-1"></a>explained_deviance <span class="ot">&lt;-</span> <span class="dv">100</span><span class="sc">*</span>(null_deviance<span class="sc">-</span>residual_deviance)<span class="sc">/</span>null_deviance</span>
<span id="cb40-513"><a href="#cb40-513" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb40-514"><a href="#cb40-514" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-515"><a href="#cb40-515" aria-hidden="true" tabindex="-1"></a>The explanatory variables included in the model explain <span class="in">`r round(explained_deviance, 1)`</span>% of the variation in total plant biomass production.</span>
<span id="cb40-516"><a href="#cb40-516" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-517"><a href="#cb40-517" aria-hidden="true" tabindex="-1"></a><span class="fu">### Step 4: Compare group means</span></span>
<span id="cb40-518"><a href="#cb40-518" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-519"><a href="#cb40-519" aria-hidden="true" tabindex="-1"></a>You can use the <span class="in">`Anova()`</span> function in the *car* package to produce an ANOVA table (in this case, an analysis of deviance table). This table shows that the two factors of our experiment interact with each other. This means that the effect of plant order of arrival on community biomass depends on the year of initiation of an experiment.</span>
<span id="cb40-520"><a href="#cb40-520" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-521"><a href="#cb40-521" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb40-522"><a href="#cb40-522" aria-hidden="true" tabindex="-1"></a><span class="fu">## Solution (code)</span></span>
<span id="cb40-523"><a href="#cb40-523" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-526"><a href="#cb40-526" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb40-527"><a href="#cb40-527" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true </span></span>
<span id="cb40-528"><a href="#cb40-528" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true </span></span>
<span id="cb40-529"><a href="#cb40-529" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false </span></span>
<span id="cb40-530"><a href="#cb40-530" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false </span></span>
<span id="cb40-531"><a href="#cb40-531" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-532"><a href="#cb40-532" aria-hidden="true" tabindex="-1"></a>table <span class="ot">&lt;-</span> <span class="fu">Anova</span>(model2)</span>
<span id="cb40-533"><a href="#cb40-533" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb40-534"><a href="#cb40-534" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-535"><a href="#cb40-535" aria-hidden="true" tabindex="-1"></a><span class="fu">## Solution (table)</span></span>
<span id="cb40-536"><a href="#cb40-536" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-539"><a href="#cb40-539" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb40-540"><a href="#cb40-540" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true </span></span>
<span id="cb40-541"><a href="#cb40-541" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true </span></span>
<span id="cb40-542"><a href="#cb40-542" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false </span></span>
<span id="cb40-543"><a href="#cb40-543" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false </span></span>
<span id="cb40-544"><a href="#cb40-544" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-545"><a href="#cb40-545" aria-hidden="true" tabindex="-1"></a>table</span>
<span id="cb40-546"><a href="#cb40-546" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb40-547"><a href="#cb40-547" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb40-548"><a href="#cb40-548" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-549"><a href="#cb40-549" aria-hidden="true" tabindex="-1"></a>To determine where the differences in community productivity lie between the plant arrival order scenarios for each sub-experiment, we need to perform a posthoc test. The <span class="in">`emmeans()`</span> function in the *emmeans* R package is a good option for this. For the <span class="in">`emmeans()`</span> function, we will need to specify a value for the following arguments:</span>
<span id="cb40-550"><a href="#cb40-550" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-551"><a href="#cb40-551" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`object`</span> (the object containing the fitted model)</span>
<span id="cb40-552"><a href="#cb40-552" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`specs`</span> (a character vector specifying the names of the predictors for which levels must be compared). In this example, this is plant arrival order.</span>
<span id="cb40-553"><a href="#cb40-553" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`by`</span> (a character vector specifying the names of the predictors to condition on). In this example, this is the year of initiation of an experiment.</span>
<span id="cb40-554"><a href="#cb40-554" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`contr`</span> (a character value specifying the contrasts to be added). We will use pairwise contrasts (i.e., all possible pairs of groups will be compared).</span>
<span id="cb40-555"><a href="#cb40-555" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-556"><a href="#cb40-556" aria-hidden="true" tabindex="-1"></a>To check the results of the posthoc test, we will then call a <span class="in">`summary()`</span> function on the object produced by <span class="in">`emmeans()`</span> . In <span class="in">`summary()`</span>, we will use the <span class="in">`type`</span> argument to specify that we want model predictions to be on the same scale as the original data (not log scale, but original scale in g/m²).</span>
<span id="cb40-557"><a href="#cb40-557" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-558"><a href="#cb40-558" aria-hidden="true" tabindex="-1"></a>What can you conclude from this posthoc test?</span>
<span id="cb40-559"><a href="#cb40-559" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-560"><a href="#cb40-560" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb40-561"><a href="#cb40-561" aria-hidden="true" tabindex="-1"></a><span class="fu">## Solution (code)</span></span>
<span id="cb40-562"><a href="#cb40-562" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-565"><a href="#cb40-565" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb40-566"><a href="#cb40-566" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true </span></span>
<span id="cb40-567"><a href="#cb40-567" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true </span></span>
<span id="cb40-568"><a href="#cb40-568" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false </span></span>
<span id="cb40-569"><a href="#cb40-569" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false </span></span>
<span id="cb40-570"><a href="#cb40-570" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-571"><a href="#cb40-571" aria-hidden="true" tabindex="-1"></a>table <span class="ot">&lt;-</span> <span class="fu">summary</span>(<span class="fu">emmeans</span>(<span class="at">object =</span> model2, </span>
<span id="cb40-572"><a href="#cb40-572" aria-hidden="true" tabindex="-1"></a>                         <span class="at">specs =</span> <span class="st">"Arrival"</span>, </span>
<span id="cb40-573"><a href="#cb40-573" aria-hidden="true" tabindex="-1"></a>                         <span class="at">by=</span> <span class="st">"Year"</span>,</span>
<span id="cb40-574"><a href="#cb40-574" aria-hidden="true" tabindex="-1"></a>                         <span class="at">contr =</span> <span class="st">"pairwise"</span>), </span>
<span id="cb40-575"><a href="#cb40-575" aria-hidden="true" tabindex="-1"></a>         <span class="at">type=</span><span class="st">"response"</span>)</span>
<span id="cb40-576"><a href="#cb40-576" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb40-577"><a href="#cb40-577" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-578"><a href="#cb40-578" aria-hidden="true" tabindex="-1"></a><span class="fu">## Solution (table)</span></span>
<span id="cb40-579"><a href="#cb40-579" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-582"><a href="#cb40-582" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb40-583"><a href="#cb40-583" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true </span></span>
<span id="cb40-584"><a href="#cb40-584" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true </span></span>
<span id="cb40-585"><a href="#cb40-585" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false </span></span>
<span id="cb40-586"><a href="#cb40-586" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false </span></span>
<span id="cb40-587"><a href="#cb40-587" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-588"><a href="#cb40-588" aria-hidden="true" tabindex="-1"></a>table</span>
<span id="cb40-589"><a href="#cb40-589" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb40-590"><a href="#cb40-590" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb40-591"><a href="#cb40-591" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-592"><a href="#cb40-592" aria-hidden="true" tabindex="-1"></a>For the sub-experiment set up in 2020, all plots where seeds were added (S, F, G, L) were on average more productive than free succession plots. Consequently, the observed effect on community productivity does not appear to be due to the manipulation of plant arrival order, but solely to whether or not seeds were sown in the plots at the start of the experiment. In 2021, there is no evidence of any difference in aboveground biomass production between plant arrival order scenarios.</span>
<span id="cb40-593"><a href="#cb40-593" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-594"><a href="#cb40-594" aria-hidden="true" tabindex="-1"></a><span class="fu">### Step 5: Add posthoc test results to the graph</span></span>
<span id="cb40-595"><a href="#cb40-595" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-596"><a href="#cb40-596" aria-hidden="true" tabindex="-1"></a>We can add posthoc test results to a graph by adding annotations. This is often done by adding letters next to the groups being compared. Groups that do not share a common letter are considered statistically significantly different from each other (p <span class="sc">\&lt;</span> 0.05). We can easily add these letters to our graph in two steps:</span>
<span id="cb40-597"><a href="#cb40-597" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-598"><a href="#cb40-598" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Start by creating a data frame (called <span class="in">`annotations`</span> in the code below) that contains all the information that *ggplot2* needs to add the annotations to your graph. In our example, this data frame should have as many rows as annotations to add to the graph and must contain the following columns:</span>
<span id="cb40-599"><a href="#cb40-599" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-600"><a href="#cb40-600" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>**Year**: the year of initiation of an experiment (2020 or 2021). Use the same column name as in <span class="in">`poem_data_biomass`</span>.</span>
<span id="cb40-601"><a href="#cb40-601" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>**Arrival**: the plant order of arrival (S, F, G, L, B). Use the same column name as in <span class="in">`poem_data_biomass`</span>.</span>
<span id="cb40-602"><a href="#cb40-602" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>**y**: the vertical coordinates where annotations should be added. You can freely choose the name of this column.</span>
<span id="cb40-603"><a href="#cb40-603" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>**Label**: the annotations to be added to the graph. You can freely choose the name of this column.</span>
<span id="cb40-604"><a href="#cb40-604" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-605"><a href="#cb40-605" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Once this is done, add an extra layer to your ggplot object using <span class="in">`geom_text()`</span>.</span>
<span id="cb40-606"><a href="#cb40-606" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-607"><a href="#cb40-607" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb40-608"><a href="#cb40-608" aria-hidden="true" tabindex="-1"></a><span class="fu">## Solution (code)</span></span>
<span id="cb40-609"><a href="#cb40-609" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-612"><a href="#cb40-612" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb40-613"><a href="#cb40-613" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true </span></span>
<span id="cb40-614"><a href="#cb40-614" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true </span></span>
<span id="cb40-615"><a href="#cb40-615" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false </span></span>
<span id="cb40-616"><a href="#cb40-616" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false </span></span>
<span id="cb40-617"><a href="#cb40-617" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb40-618"><a href="#cb40-618" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-619"><a href="#cb40-619" aria-hidden="true" tabindex="-1"></a>annotations <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Year=</span><span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">2020</span>,<span class="dv">2021</span>), <span class="at">each=</span><span class="dv">5</span>),</span>
<span id="cb40-620"><a href="#cb40-620" aria-hidden="true" tabindex="-1"></a>                          <span class="at">Arrival=</span><span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"S"</span>, <span class="st">"F"</span>, <span class="st">"G"</span>, <span class="st">"L"</span>, <span class="st">"B"</span>), <span class="dv">2</span>),</span>
<span id="cb40-621"><a href="#cb40-621" aria-hidden="true" tabindex="-1"></a>                          <span class="at">y=</span><span class="fu">rep</span>(<span class="dv">600</span>, <span class="dv">10</span>),</span>
<span id="cb40-622"><a href="#cb40-622" aria-hidden="true" tabindex="-1"></a>                          <span class="at">Label=</span><span class="fu">c</span>(<span class="st">"a"</span>, <span class="st">"a"</span>, <span class="st">"a"</span>, <span class="st">"a"</span>, <span class="st">"b"</span>, <span class="st">"a"</span>, <span class="st">"a"</span>, <span class="st">"a"</span>, <span class="st">"a"</span>, <span class="st">"a"</span>))</span>
<span id="cb40-623"><a href="#cb40-623" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-624"><a href="#cb40-624" aria-hidden="true" tabindex="-1"></a>plot <span class="ot">&lt;-</span> poem_data_biomass <span class="sc">|&gt;</span> </span>
<span id="cb40-625"><a href="#cb40-625" aria-hidden="true" tabindex="-1"></a>          <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>Arrival,</span>
<span id="cb40-626"><a href="#cb40-626" aria-hidden="true" tabindex="-1"></a>                     <span class="at">y=</span>Total_biomass))<span class="sc">+</span></span>
<span id="cb40-627"><a href="#cb40-627" aria-hidden="true" tabindex="-1"></a>          <span class="fu">facet_grid</span>(<span class="sc">~</span>Year)<span class="sc">+</span></span>
<span id="cb40-628"><a href="#cb40-628" aria-hidden="true" tabindex="-1"></a>          <span class="fu">geom_jitter</span>(<span class="at">height =</span> <span class="dv">0</span>,</span>
<span id="cb40-629"><a href="#cb40-629" aria-hidden="true" tabindex="-1"></a>                      <span class="at">width=</span><span class="fl">0.1</span>,</span>
<span id="cb40-630"><a href="#cb40-630" aria-hidden="true" tabindex="-1"></a>                      <span class="at">shape=</span><span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb40-631"><a href="#cb40-631" aria-hidden="true" tabindex="-1"></a>          <span class="fu">stat_summary</span>(<span class="at">fun.data =</span> <span class="st">"mean_cl_boot"</span>)<span class="sc">+</span></span>
<span id="cb40-632"><a href="#cb40-632" aria-hidden="true" tabindex="-1"></a>          <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb40-633"><a href="#cb40-633" aria-hidden="true" tabindex="-1"></a>          <span class="fu">xlab</span>(<span class="st">"Plant order of arrival"</span>)<span class="sc">+</span></span>
<span id="cb40-634"><a href="#cb40-634" aria-hidden="true" tabindex="-1"></a>          <span class="fu">ylab</span>(<span class="st">"Total shoot dry weight (g/m²)"</span>)<span class="sc">+</span></span>
<span id="cb40-635"><a href="#cb40-635" aria-hidden="true" tabindex="-1"></a>          <span class="fu">theme</span>(<span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t=</span><span class="dv">10</span>)),</span>
<span id="cb40-636"><a href="#cb40-636" aria-hidden="true" tabindex="-1"></a>                <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">r=</span><span class="dv">10</span>)),</span>
<span id="cb40-637"><a href="#cb40-637" aria-hidden="true" tabindex="-1"></a>                <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">colour=</span><span class="st">"black"</span>))<span class="sc">+</span></span>
<span id="cb40-638"><a href="#cb40-638" aria-hidden="true" tabindex="-1"></a>          <span class="fu">scale_y_continuous</span>(<span class="at">breaks=</span><span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">100</span>,</span>
<span id="cb40-639"><a href="#cb40-639" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">to =</span> <span class="dv">600</span>,</span>
<span id="cb40-640"><a href="#cb40-640" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">by =</span> <span class="dv">100</span>))<span class="sc">+</span></span>
<span id="cb40-641"><a href="#cb40-641" aria-hidden="true" tabindex="-1"></a>          <span class="fu">geom_text</span>(<span class="at">data=</span>annotations,</span>
<span id="cb40-642"><a href="#cb40-642" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">aes</span>(<span class="at">x=</span>Arrival,</span>
<span id="cb40-643"><a href="#cb40-643" aria-hidden="true" tabindex="-1"></a>                        <span class="at">y=</span>y,</span>
<span id="cb40-644"><a href="#cb40-644" aria-hidden="true" tabindex="-1"></a>                        <span class="at">label=</span>Label))</span>
<span id="cb40-645"><a href="#cb40-645" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb40-646"><a href="#cb40-646" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-647"><a href="#cb40-647" aria-hidden="true" tabindex="-1"></a><span class="fu">## Solution (plot)</span></span>
<span id="cb40-648"><a href="#cb40-648" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-651"><a href="#cb40-651" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb40-652"><a href="#cb40-652" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true </span></span>
<span id="cb40-653"><a href="#cb40-653" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true </span></span>
<span id="cb40-654"><a href="#cb40-654" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false </span></span>
<span id="cb40-655"><a href="#cb40-655" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false </span></span>
<span id="cb40-656"><a href="#cb40-656" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb40-657"><a href="#cb40-657" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-658"><a href="#cb40-658" aria-hidden="true" tabindex="-1"></a>plot</span>
<span id="cb40-659"><a href="#cb40-659" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb40-660"><a href="#cb40-660" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb40-661"><a href="#cb40-661" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-662"><a href="#cb40-662" aria-hidden="true" tabindex="-1"></a><span class="fu">## Exercise 2: Non-metric multidimensional scaling</span></span>
<span id="cb40-663"><a href="#cb40-663" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-664"><a href="#cb40-664" aria-hidden="true" tabindex="-1"></a><span class="fu">### Step 1: Choose a measure of association</span></span>
<span id="cb40-665"><a href="#cb40-665" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-666"><a href="#cb40-666" aria-hidden="true" tabindex="-1"></a>**Non-metric multidimensional scaling** (NMDS) is a technique often used in ecological research to visualise differences (or (dis)similarities) in species composition between ecological communities.</span>
<span id="cb40-667"><a href="#cb40-667" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-668"><a href="#cb40-668" aria-hidden="true" tabindex="-1"></a>The first step is to choose a measure of association and calculate a dissimilarity matrix. This dissimilarity matrix will have as many rows and columns as ecological communities to be compared. The help page of the <span class="in">`vegdist()`</span> function of the *vegan* package lists a number of dissimilarity indices for ecologists wishing to quantify dissimilarity in species composition between communities. You can access this help page by running <span class="in">`?vegdist`</span> in your R console (a detailed discussion of the advantages and disadvantages of each dissimilarity index is beyond the scope of this tutorial). The Bray-Curtis dissimilarity is usually good at detecting ecological gradients (see <span class="in">`?vegdist`</span>) and is often used as default when performing NMDS. This is the dissimilarity index we are going to use in this tutorial too.</span>
<span id="cb40-669"><a href="#cb40-669" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-670"><a href="#cb40-670" aria-hidden="true" tabindex="-1"></a><span class="fu">### Step 2: Organise your data</span></span>
<span id="cb40-671"><a href="#cb40-671" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-672"><a href="#cb40-672" aria-hidden="true" tabindex="-1"></a>To obtain the dissimilarity matrix required for NMDS, we first need to reorganise our data so that each species has its own column and each ecological community has its own row (i.e., a site-by-species matrix). Use the <span class="in">`poem_data`</span> object as a starting point. In your code, include the following steps:</span>
<span id="cb40-673"><a href="#cb40-673" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-674"><a href="#cb40-674" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Store the dataset in a new object called <span class="in">`poem_data_wide`</span>.</span>
<span id="cb40-675"><a href="#cb40-675" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Standardise biomass data in g/m². Each quadrat has a surface area of 0.1 m². Use <span class="in">`mutate()`</span> to add a new column called "Std_biomass" to the dataset.</span>
<span id="cb40-676"><a href="#cb40-676" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Depending on the harvest date, all plant species located within 2 or 4 randomly positioned quadrats were collected in each plot. To obtain a biomass value per species and per plot, it is first necessary to calculate the average biomass value for each species in a plot at each harvest date (i.e., across quadrats). Use <span class="in">`group_by()`</span> and <span class="in">`summarise()`</span> to do that.</span>
<span id="cb40-677"><a href="#cb40-677" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Use <span class="in">`pivot_wider()`</span> to reorganise your data (one column per species).</span>
<span id="cb40-678"><a href="#cb40-678" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Only keep the data for the second harvest date of each sub-experiment (2021-06 for the experiment initiated in 2020, 2022-06 for the experiment initiated in 2021).</span>
<span id="cb40-679"><a href="#cb40-679" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Remove all species columns that only contain zeros. You can do this using <span class="in">`select(where( ~ is.numeric(.x) &amp;&amp; sum(.x) != 0))`</span>.</span>
<span id="cb40-680"><a href="#cb40-680" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Remove the column named "Unknown".</span>
<span id="cb40-681"><a href="#cb40-681" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-684"><a href="#cb40-684" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb40-685"><a href="#cb40-685" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true </span></span>
<span id="cb40-686"><a href="#cb40-686" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true </span></span>
<span id="cb40-687"><a href="#cb40-687" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false </span></span>
<span id="cb40-688"><a href="#cb40-688" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false </span></span>
<span id="cb40-689"><a href="#cb40-689" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-690"><a href="#cb40-690" aria-hidden="true" tabindex="-1"></a>poem_data_wide <span class="ot">&lt;-</span> poem_data <span class="sc">|&gt;</span> </span>
<span id="cb40-691"><a href="#cb40-691" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Std_biomass=</span>Biomass<span class="sc">/</span><span class="fl">0.1</span>, <span class="co">#Convert to g/m²</span></span>
<span id="cb40-692"><a href="#cb40-692" aria-hidden="true" tabindex="-1"></a>         <span class="at">.after =</span> <span class="st">"Biomass"</span>) <span class="sc">|&gt;</span>  <span class="co">#Specify that we want this new column to be after the Biomass column</span></span>
<span id="cb40-693"><a href="#cb40-693" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Year, Harvest, PlotID, Arrival, Species) <span class="sc">|&gt;</span> <span class="co">#Define grouping factors in your data</span></span>
<span id="cb40-694"><a href="#cb40-694" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Std_biomass=</span><span class="fu">mean</span>(Std_biomass)) <span class="sc">|&gt;</span> </span>
<span id="cb40-695"><a href="#cb40-695" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> Species, <span class="co">#Species names will be used as column names</span></span>
<span id="cb40-696"><a href="#cb40-696" aria-hidden="true" tabindex="-1"></a>              <span class="at">values_from =</span> Std_biomass, <span class="co">#Biomass values are stored in the Std_biomass column</span></span>
<span id="cb40-697"><a href="#cb40-697" aria-hidden="true" tabindex="-1"></a>              <span class="at">values_fill =</span> <span class="dv">0</span>, <span class="co">#If a species is absent in a plot, its biomass value is zero</span></span>
<span id="cb40-698"><a href="#cb40-698" aria-hidden="true" tabindex="-1"></a>              <span class="at">values_fn =</span> sum) <span class="sc">|&gt;</span>  <span class="co">#Sum biomass values measured on the same species and in the same quadrat</span></span>
<span id="cb40-699"><a href="#cb40-699" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>((Year <span class="sc">==</span> <span class="dv">2020</span> <span class="sc">&amp;</span> Harvest <span class="sc">==</span> <span class="st">"2021-06"</span>)<span class="sc">|</span>(Year <span class="sc">==</span> <span class="dv">2021</span> <span class="sc">&amp;</span> Harvest <span class="sc">==</span> <span class="st">"2022-06"</span>)) <span class="sc">|&gt;</span>  <span class="co">#Filter data</span></span>
<span id="cb40-700"><a href="#cb40-700" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">where</span>( <span class="sc">~</span> <span class="fu">is.numeric</span>(.x) <span class="sc">&amp;&amp;</span> <span class="fu">sum</span>(.x) <span class="sc">!=</span> <span class="dv">0</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb40-701"><a href="#cb40-701" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>Unknown)</span>
<span id="cb40-702"><a href="#cb40-702" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-703"><a href="#cb40-703" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(<span class="fu">head</span>(poem_data_wide, <span class="dv">10</span>))</span>
<span id="cb40-704"><a href="#cb40-704" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb40-705"><a href="#cb40-705" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-706"><a href="#cb40-706" aria-hidden="true" tabindex="-1"></a><span class="fu">### Step 3: Perform the NMDS</span></span>
<span id="cb40-707"><a href="#cb40-707" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-708"><a href="#cb40-708" aria-hidden="true" tabindex="-1"></a>Now that our community dataset has the right format, we can perform the NMDS using the <span class="in">`metaMDS()`</span> function of the *vegan* package. The following arguments are of particular importance:</span>
<span id="cb40-709"><a href="#cb40-709" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-710"><a href="#cb40-710" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`comm`</span>: the community data (only select the species columns).</span>
<span id="cb40-711"><a href="#cb40-711" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`distance`</span>: a character value for the dissimilarity index used. Use "bray" for the Bray-Curtis dissimilarity index.</span>
<span id="cb40-712"><a href="#cb40-712" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`k`</span>: the number of dimensions to compute. Let's start with <span class="in">`k=2`</span> (we want to produce a 2D plot).</span>
<span id="cb40-713"><a href="#cb40-713" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`trymax`</span>: the maximum number of random starts in search of a stable solution. The NMDS algorithm iteratively searches for a stable solution (numerical optimisation methods). Increasing the value of this argument can help reaching a stable solution.</span>
<span id="cb40-714"><a href="#cb40-714" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-715"><a href="#cb40-715" aria-hidden="true" tabindex="-1"></a>We will keep the default values for all other arguments. Store the results in an object named <span class="in">`nmds`</span>. Do not forget to set a seed (using <span class="in">`set.seed()`</span> for reproducibility).</span>
<span id="cb40-716"><a href="#cb40-716" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-719"><a href="#cb40-719" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb40-720"><a href="#cb40-720" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true </span></span>
<span id="cb40-721"><a href="#cb40-721" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true </span></span>
<span id="cb40-722"><a href="#cb40-722" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false </span></span>
<span id="cb40-723"><a href="#cb40-723" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false </span></span>
<span id="cb40-724"><a href="#cb40-724" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-725"><a href="#cb40-725" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb40-726"><a href="#cb40-726" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-727"><a href="#cb40-727" aria-hidden="true" tabindex="-1"></a>nmds <span class="ot">&lt;-</span> <span class="fu">metaMDS</span>(<span class="at">comm =</span> poem_data_wide[,<span class="dv">5</span><span class="sc">:</span><span class="fu">ncol</span>(poem_data_wide)],</span>
<span id="cb40-728"><a href="#cb40-728" aria-hidden="true" tabindex="-1"></a>                <span class="at">distance =</span> <span class="st">"bray"</span>,</span>
<span id="cb40-729"><a href="#cb40-729" aria-hidden="true" tabindex="-1"></a>                <span class="at">k =</span> <span class="dv">2</span>,</span>
<span id="cb40-730"><a href="#cb40-730" aria-hidden="true" tabindex="-1"></a>                <span class="at">trymax =</span> <span class="dv">100</span>)</span>
<span id="cb40-731"><a href="#cb40-731" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb40-732"><a href="#cb40-732" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-733"><a href="#cb40-733" aria-hidden="true" tabindex="-1"></a><span class="fu">### Step 4: Check NMDS results</span></span>
<span id="cb40-734"><a href="#cb40-734" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-735"><a href="#cb40-735" aria-hidden="true" tabindex="-1"></a>The main goal of NMDS is to visualise a dissimilarity matrix in a lower (typically 2D) dimensional space. Contrary to principal coordinate analysis (PCoA), which aims to create a plot in which distances between points match the original dissimilarities as closely as possible, NMDS focuses on representing the order, or ranking, of the original dissimilarities as closely as possible (Zuur AF, Ieno EN, Smith GM. 2007. *Analysing ecological data*. Springer.).</span>
<span id="cb40-736"><a href="#cb40-736" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-737"><a href="#cb40-737" aria-hidden="true" tabindex="-1"></a>The first way to assess the quality of the display is to look at a parameter called "stress". You can extract it from the <span class="in">`nmds`</span> object created earlier using <span class="in">`nmds$stress`</span>. In our example, the stress value is equal to <span class="in">`r round(nmds$stress, 3)`</span>. Zuur et al (2007) provided some guidelines on how to interpret stress values (usually, the lower the stress value, the better):</span>
<span id="cb40-738"><a href="#cb40-738" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-739"><a href="#cb40-739" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>stress <span class="sc">\&lt;</span> 0.05: Excellent configuration</span>
<span id="cb40-740"><a href="#cb40-740" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>stress between 0.05 and 0.1: Good configuration</span>
<span id="cb40-741"><a href="#cb40-741" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>stress between 0.1 and 0.2: Be careful with interpretation</span>
<span id="cb40-742"><a href="#cb40-742" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>stress between 0.2 and 0.3: Problems start. Consider increasing the number of dimensions (<span class="in">`k`</span>).</span>
<span id="cb40-743"><a href="#cb40-743" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>stress above 0.3: Poor representation. Increase the number of dimensions (<span class="in">`k`</span>).</span>
<span id="cb40-744"><a href="#cb40-744" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-745"><a href="#cb40-745" aria-hidden="true" tabindex="-1"></a>Another way to assess the quality of the configuration is to create a Shepard plot. A Shepard plot shows the relationship between ordination distances (i.e., distances in the configuration produced by the NMDS) and original distances. You can produce a Shepard plot using the <span class="in">`stressplot()`</span> function in *vegan*. What can you conclude from this Shepard plot?</span>
<span id="cb40-746"><a href="#cb40-746" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-749"><a href="#cb40-749" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb40-750"><a href="#cb40-750" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true </span></span>
<span id="cb40-751"><a href="#cb40-751" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true </span></span>
<span id="cb40-752"><a href="#cb40-752" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false </span></span>
<span id="cb40-753"><a href="#cb40-753" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb40-754"><a href="#cb40-754" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb40-755"><a href="#cb40-755" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-756"><a href="#cb40-756" aria-hidden="true" tabindex="-1"></a><span class="fu">stressplot</span>(nmds)</span>
<span id="cb40-757"><a href="#cb40-757" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb40-758"><a href="#cb40-758" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-759"><a href="#cb40-759" aria-hidden="true" tabindex="-1"></a><span class="fu">### Step 5: Visualise NMDS results</span></span>
<span id="cb40-760"><a href="#cb40-760" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-761"><a href="#cb40-761" aria-hidden="true" tabindex="-1"></a>NMDS results are stored in our <span class="in">`nmds`</span> object. You can extract the coordinates of each community using <span class="in">`nmds$points`</span>. To make it easier to work with *ggplot2*, we will create a new data frame (<span class="in">`data_nmds`</span>) by merging the first four columns of <span class="in">`poem_data_wide`</span> (Harvest, Arrival, Year, PlotID) with NMDS results.</span>
<span id="cb40-762"><a href="#cb40-762" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-765"><a href="#cb40-765" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb40-766"><a href="#cb40-766" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true </span></span>
<span id="cb40-767"><a href="#cb40-767" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true </span></span>
<span id="cb40-768"><a href="#cb40-768" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false </span></span>
<span id="cb40-769"><a href="#cb40-769" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb40-770"><a href="#cb40-770" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-771"><a href="#cb40-771" aria-hidden="true" tabindex="-1"></a>data_nmds <span class="ot">&lt;-</span> <span class="fu">cbind</span>(poem_data_wide[, <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>], nmds<span class="sc">$</span>points)</span>
<span id="cb40-772"><a href="#cb40-772" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-773"><a href="#cb40-773" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(<span class="fu">head</span>(data_nmds, <span class="dv">10</span>))</span>
<span id="cb40-774"><a href="#cb40-774" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb40-775"><a href="#cb40-775" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-776"><a href="#cb40-776" aria-hidden="true" tabindex="-1"></a>We now have everything we need to plot the results of the NMDS using *ggplot2*:</span>
<span id="cb40-777"><a href="#cb40-777" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-778"><a href="#cb40-778" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Create a plot displaying MDS1 on the horizontal axis and MDS2 on the vertical axis.</span>
<span id="cb40-779"><a href="#cb40-779" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Use a specific colour for each plant order of arrival scenario (mind colour-blind people!).</span>
<span id="cb40-780"><a href="#cb40-780" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Use a specific shape for each year of initiation.</span>
<span id="cb40-781"><a href="#cb40-781" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Add an informative legend to your graph.</span>
<span id="cb40-782"><a href="#cb40-782" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Add an annotation on the top left corner of your graph for the stress value. Use <span class="in">`geom_text()`</span> to do that.</span>
<span id="cb40-783"><a href="#cb40-783" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-784"><a href="#cb40-784" aria-hidden="true" tabindex="-1"></a>What can you conclude from this NMDS?</span>
<span id="cb40-785"><a href="#cb40-785" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-786"><a href="#cb40-786" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb40-787"><a href="#cb40-787" aria-hidden="true" tabindex="-1"></a><span class="fu">## Solution (code)</span></span>
<span id="cb40-788"><a href="#cb40-788" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-791"><a href="#cb40-791" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb40-792"><a href="#cb40-792" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true </span></span>
<span id="cb40-793"><a href="#cb40-793" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true </span></span>
<span id="cb40-794"><a href="#cb40-794" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false </span></span>
<span id="cb40-795"><a href="#cb40-795" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb40-796"><a href="#cb40-796" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-797"><a href="#cb40-797" aria-hidden="true" tabindex="-1"></a><span class="co">#Make sure that Arrival and Year are factors</span></span>
<span id="cb40-798"><a href="#cb40-798" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-799"><a href="#cb40-799" aria-hidden="true" tabindex="-1"></a>data_nmds<span class="sc">$</span>Arrival <span class="ot">&lt;-</span> <span class="fu">factor</span>(data_nmds<span class="sc">$</span>Arrival,</span>
<span id="cb40-800"><a href="#cb40-800" aria-hidden="true" tabindex="-1"></a>                            <span class="at">levels=</span><span class="fu">c</span>(<span class="st">"S"</span>, <span class="st">"F"</span>, <span class="st">"G"</span>, <span class="st">"L"</span>, <span class="st">"B"</span>))</span>
<span id="cb40-801"><a href="#cb40-801" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-802"><a href="#cb40-802" aria-hidden="true" tabindex="-1"></a>data_nmds<span class="sc">$</span>Year <span class="ot">&lt;-</span> <span class="fu">factor</span>(data_nmds<span class="sc">$</span>Year,</span>
<span id="cb40-803"><a href="#cb40-803" aria-hidden="true" tabindex="-1"></a>                         <span class="at">levels=</span><span class="fu">c</span>(<span class="st">"2020"</span>, <span class="st">"2021"</span>))</span>
<span id="cb40-804"><a href="#cb40-804" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-805"><a href="#cb40-805" aria-hidden="true" tabindex="-1"></a><span class="co">#Plot results</span></span>
<span id="cb40-806"><a href="#cb40-806" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-807"><a href="#cb40-807" aria-hidden="true" tabindex="-1"></a>plot <span class="ot">&lt;-</span> data_nmds <span class="sc">|&gt;</span> </span>
<span id="cb40-808"><a href="#cb40-808" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> MDS1,</span>
<span id="cb40-809"><a href="#cb40-809" aria-hidden="true" tabindex="-1"></a>             <span class="at">y =</span> MDS2,</span>
<span id="cb40-810"><a href="#cb40-810" aria-hidden="true" tabindex="-1"></a>             <span class="at">colour =</span> Arrival,</span>
<span id="cb40-811"><a href="#cb40-811" aria-hidden="true" tabindex="-1"></a>             <span class="at">shape =</span> Year))<span class="sc">+</span></span>
<span id="cb40-812"><a href="#cb40-812" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size=</span><span class="dv">2</span>)<span class="sc">+</span></span>
<span id="cb40-813"><a href="#cb40-813" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb40-814"><a href="#cb40-814" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_colour_viridis</span>(<span class="at">name =</span> <span class="st">"Plant order of arrival"</span>,</span>
<span id="cb40-815"><a href="#cb40-815" aria-hidden="true" tabindex="-1"></a>                       <span class="at">discrete =</span> <span class="cn">TRUE</span>,</span>
<span id="cb40-816"><a href="#cb40-816" aria-hidden="true" tabindex="-1"></a>                       <span class="at">option =</span> <span class="st">"D"</span>)<span class="sc">+</span></span>
<span id="cb40-817"><a href="#cb40-817" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="at">name =</span> <span class="st">"Year of initiation"</span>,</span>
<span id="cb40-818"><a href="#cb40-818" aria-hidden="true" tabindex="-1"></a>                     <span class="at">values =</span> <span class="fu">c</span>(<span class="dv">16</span>, <span class="dv">17</span>))<span class="sc">+</span></span>
<span id="cb40-819"><a href="#cb40-819" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">colour=</span><span class="st">"black"</span>),</span>
<span id="cb40-820"><a href="#cb40-820" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t=</span><span class="dv">10</span>)),</span>
<span id="cb40-821"><a href="#cb40-821" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">r=</span><span class="dv">10</span>)))<span class="sc">+</span></span>
<span id="cb40-822"><a href="#cb40-822" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"NMDS1"</span>)<span class="sc">+</span></span>
<span id="cb40-823"><a href="#cb40-823" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"NMDS2"</span>)<span class="sc">+</span></span>
<span id="cb40-824"><a href="#cb40-824" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data=</span><span class="fu">data.frame</span>(<span class="at">x=</span><span class="fu">min</span>(data_nmds<span class="sc">$</span>MDS1),</span>
<span id="cb40-825"><a href="#cb40-825" aria-hidden="true" tabindex="-1"></a>                            <span class="at">y=</span><span class="fu">max</span>(data_nmds<span class="sc">$</span>MDS2),</span>
<span id="cb40-826"><a href="#cb40-826" aria-hidden="true" tabindex="-1"></a>                            <span class="at">label=</span><span class="fu">paste</span>(<span class="st">"Stress = "</span>, </span>
<span id="cb40-827"><a href="#cb40-827" aria-hidden="true" tabindex="-1"></a>                                        <span class="fu">round</span>(nmds<span class="sc">$</span>stress, <span class="dv">3</span>), </span>
<span id="cb40-828"><a href="#cb40-828" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">sep=</span><span class="st">""</span>)), </span>
<span id="cb40-829"><a href="#cb40-829" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">x =</span> x, </span>
<span id="cb40-830"><a href="#cb40-830" aria-hidden="true" tabindex="-1"></a>                <span class="at">y =</span> y, </span>
<span id="cb40-831"><a href="#cb40-831" aria-hidden="true" tabindex="-1"></a>                <span class="at">label =</span> label),</span>
<span id="cb40-832"><a href="#cb40-832" aria-hidden="true" tabindex="-1"></a>            <span class="at">hjust =</span> <span class="fl">0.1</span>, </span>
<span id="cb40-833"><a href="#cb40-833" aria-hidden="true" tabindex="-1"></a>            <span class="at">vjust =</span> <span class="dv">0</span>, </span>
<span id="cb40-834"><a href="#cb40-834" aria-hidden="true" tabindex="-1"></a>            <span class="at">inherit.aes =</span> <span class="cn">FALSE</span>)</span>
<span id="cb40-835"><a href="#cb40-835" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb40-836"><a href="#cb40-836" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-837"><a href="#cb40-837" aria-hidden="true" tabindex="-1"></a><span class="fu">## Solution (plot)</span></span>
<span id="cb40-838"><a href="#cb40-838" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-841"><a href="#cb40-841" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb40-842"><a href="#cb40-842" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true </span></span>
<span id="cb40-843"><a href="#cb40-843" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true </span></span>
<span id="cb40-844"><a href="#cb40-844" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false </span></span>
<span id="cb40-845"><a href="#cb40-845" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb40-846"><a href="#cb40-846" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb40-847"><a href="#cb40-847" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-848"><a href="#cb40-848" aria-hidden="true" tabindex="-1"></a>plot</span>
<span id="cb40-849"><a href="#cb40-849" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb40-850"><a href="#cb40-850" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb40-851"><a href="#cb40-851" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-854"><a href="#cb40-854" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb40-855"><a href="#cb40-855" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true </span></span>
<span id="cb40-856"><a href="#cb40-856" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false </span></span>
<span id="cb40-857"><a href="#cb40-857" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false </span></span>
<span id="cb40-858"><a href="#cb40-858" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false  </span></span>
<span id="cb40-859"><a href="#cb40-859" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-860"><a href="#cb40-860" aria-hidden="true" tabindex="-1"></a><span class="fu">unlink</span>(<span class="st">"Data_POEM"</span>, <span class="at">recursive =</span> <span class="cn">TRUE</span>) </span>
<span id="cb40-861"><a href="#cb40-861" aria-hidden="true" tabindex="-1"></a><span class="fu">file.remove</span>(<span class="st">"Data_POEM_Paper1_Alonso-Crespo_et_al_2024-v1.0.zip"</span>)</span>
<span id="cb40-862"><a href="#cb40-862" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">This website is built and maintained with ☕ and <a href="https://quarto.org/">Quarto</a>.</div>
  </div>
</footer>



</body></html>